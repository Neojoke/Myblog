---
title: å¸¦ä½ ä¸€æ­¥æ­¥æ„å»ºiOSè·¯ç”±
date:  2016-12-17 14:25:00
categories:
- è°‹-æŠ€æœ¯æ–¹æ¡ˆ
tags:
- æ¶æ„è®¾è®¡
- ç§»åŠ¨ç«¯
---
![](http://upload-images.jianshu.io/upload_images/24274-9e53c673e27b3015.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
>æ¥ä¸Šä¸€ç¯‡[ç§»åŠ¨ç«¯è·¯ç”±å±‚è®¾è®¡](http://www.jianshu.com/p/be7da3ed4100),è¿™ä¸€ç¯‡æ˜¯å®æˆ˜ç¯‡ï¼Œæ‰‹æŠŠæ‰‹çš„å¸¦ä½ ç¼–å†™ä¸€ä¸ªç®€å•çš„è·¯ç”±ç»„ä»¶ã€‚æœ‰æœ‹å‹è¯´å¾ˆå¤šäººéƒ½æ”¶è—ä»¥åå°±å†ä¹Ÿæ²¡çœ‹è¿‡ï¼Œå…¶å®è¿™å±äºæ—¶é—´ç®¡ç†é—®é¢˜ï¼Œåœ¨ä½ å¿™ç¢Œçš„å·¥ä½œå’Œç”Ÿæ´»çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™éœ€è¦ä½ ç¨å¾®åœé¡¿ä¸€ä¸‹ï¼Œæ€è€ƒä¸€ä¸‹ï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥æŠŠæœ¬ç¯‡æ–‡ç« æ”¶è—ä»¥åå†åœ¨iPhoneçš„æé†’äº‹é¡¹é‡ŒåŠ å…¥åˆ°ä¸€ä¸ªé˜…è¯»æ¸…å•é‡Œï¼Œä¸ç”¨è®¾ç½®æé†’ï¼Œåªéœ€è¦åœ¨ä½ é—²çš„æ—¶å€™æŠ½å‡ºä¸€ä¸¤ä¸ªå°æ—¶ï¼Œçœ‹ä¸€ä¸‹ã€‚æƒ³è±¡ä¸€ä¸‹ä½ è‡ªå·±åŠ¨æ‰‹ä»å‘ç°é—®é¢˜åˆ°è§£å†³é—®é¢˜å†åˆ°åšå‡ºä¸€ä¸ªè§£å†³é—®é¢˜çš„ç»„ä»¶çš„è¿‡ç¨‹ç»™ä½ å¸¦æ¥çš„æˆå°±æ„Ÿå’Œè·å–çš„è¿›é˜¶ç»éªŒï¼Œå†ç¨å¾®æ”¹å˜ä¸€ä¸‹ä½ å¯¹æ¯å¤©éœ€è¦å¤„ç†çš„ç¹æ‚äº‹ç‰©çš„ç®¡ç†æ–¹å¼ï¼Œä¹Ÿè®¸ä½ çš„ç”Ÿæ´»å’Œå·¥ä½œå°±ä¼šè±ç„¶å¼€æœ—ã€‚

### è¿™ä¸ªè·¯ç”±ç©¶ç«Ÿæ˜¯ä»€ä¹ˆé¬¼ï¼Ÿèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ
#### ä¸¾ä¸€äº›åœºæ™¯æ¥çœ‹çœ‹
åœºæ™¯1ï¼šä¸€ä¸ªAppé¡¹ç›®ä¸­å›¢é˜Ÿäººå‘˜æ¯”è¾ƒå¤šï¼Œä¸åŒçš„äººè´Ÿè´£ä¸åŒçš„æ¨¡å—å¼€å‘ï¼Œæœ‰çš„äººç›´æ¥ä½¿ç”¨èµ„æºæ–‡ä»¶è®¾è®¡çš„ï¼Œæœ‰çš„äººç”¨ä»£ç ç›´æ¥å†™çš„ï¼Œæœ‰çš„äººè´Ÿè´£ç™»å½•ï¼Œæœ‰çš„äººè´Ÿè´£è®¢å•ï¼Œçªç„¶æœ‰ä¸€å¤©æè®¢å•çš„å¼€å‘Aæ‰¾æç™»å½•çš„å¼€å‘Bè¯´è¦è°ƒä¸€ä¸‹ç™»å½•ï¼Œç™»å½•æˆåŠŸä»¥åä½ è¦å†å›è°ƒä¸‹æˆ‘å†™çš„æ¨¡å—çš„æ–¹æ³•å‘Šè¯‰æˆ‘æˆåŠŸç™»å½•ï¼Œæˆ‘è¦åˆ·æ–°ä¸€ä¸‹è®¢å•é¡µé¢ï¼ŒBå‚»å‚»çš„å°±ç­”åº”äº†ï¼Œæ‰¾Bçš„äººCã€Dã€F....è¶Šæ¥è¶Šå¤šï¼ŒBè´Ÿè´£çš„ä»£ç è¶Šå†™è¶Šå¤šï¼ŒåŒæ—¶Aä¹Ÿä¸æ€ä¹ˆå¼€å¿ƒï¼Œå› ä¸ºAå‘ç°è°ƒBå†™çš„ç™»å½•è¦é€šè¿‡ç±»å®ä¾‹åŒ–å‡½æ•°è·å–æ¨¡å—ï¼Œè°ƒCå†™çš„æ”¯ä»˜ä½¿ç”¨å·¥å‚æ–¹æ³•ï¼Œè°ƒDå†™çš„è®¡ç®—å™¨ç»„ä»¶åˆæ˜¯å¦å¤–ä¸€ç§å†™æ³•ï¼Œç»“æœAè‡ªå·±çš„ä»£ç ä¹Ÿè¶Šæ¥è¶Šä¸‘ã€‚

åœºæ™¯2ï¼šä¸€ä¸ªAppé‡Œé¢æœ‰å¾ˆå¤šå†…åµŒçš„H5é¡µé¢ï¼Œç¼ å“Aå¯¹çŒ¿Bè¯´ï¼Œæˆ‘ä»¬çš„æ´»åŠ¨é¡µé¢è¦è°ƒç”¨ä¸€ä¸‹æˆ‘ä»¬çš„è®¢å•é¡µé¢ï¼Œç”¨æˆ·å¦‚æœä¸‹äº†ä¸€ä¸ªè®¢å•æˆåŠŸä»¥åH5è¦èƒ½å¤Ÿæ‹¿åˆ°åé¦ˆæœ‰æ¬¢è¿è¯­ï¼ŒçŒ¿Bå’ŒH5çš„å¼€å‘çŒ¿Cç»è¿‡å¾ˆä¹…å¾ˆä¹…çš„è®¨è®ºï¼Œç¡®å®šäº†H5å¦‚æœè°ƒç”¨Appçš„è®¢å•é¡µé¢ï¼Œå‚æ•°æ€ä¹ˆä¼ ï¼Œè®¢å•æäº¤ä»¥åæ€ä¹ˆå†è°ƒH5çš„æ¥å£ï¼Œå‚æ•°æ€ä¹ˆå®šä¹‰ï¼Œå„è‡ªæŠŠä»£ç å†™åˆ°å„è‡ªçš„é¡¹ç›®é‡Œï¼Œæ²¡è¿‡å¤šä¹…ç¼ å“Aè¯´å¦å¤–çš„H5è¦è°ƒç”¨åŸç”Ÿçš„ç•Œé¢ï¼Œæ€ä¹ˆæ€ä¹ˆä¸ªæµç¨‹ï¼Œæ¨é€ç‚¹å‡»è¦è°ƒç”¨åŸç”Ÿçš„æŸä¸ªé¡µé¢ï¼Œç‚¹å®Œè¦åé¦ˆç»™åå°ç»Ÿè®¡ï¼Œå…„å¼ŸAppè¦è·³è½¬åˆ°æˆ‘ä»¬çš„AppæŸä¸ªé¡µé¢è·³è½¬å®ŒæˆæŸä¸ªåŠ¨ä½œä»¥åè¦å†è·³è½¬å›å»......çŒ¿Bæ¯æ¯æ¥åˆ°è¿™æ ·çš„éœ€æ±‚å°±ç´§ç´§æ¡ä½è‡ªå·±ä¸­ç®­çš„è†ç›–ï¼Œæ”¶æ‹¾äº†ä¸€ä¸‹å†™çš„é‚£ä¹ˆå¤šä»£ç ï¼Œæ·±è—åŠŸä¸å......ğŸŒš.
#### å‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ
æˆ‘æƒ³ä¸Šé¢çš„ä¸¤ä¸ªåœºæ™¯å‡ºç°çš„é—®é¢˜å¤§å®¶æˆ–å¤šæˆ–å°‘éƒ½ä¼šé‡è§ï¼Œæ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼š
1. å› ä¸ºä¸åŒäººè´Ÿè´£ä¸åŒæ¨¡å—ï¼Œè°ƒç”¨ä»–äººå¿…é¡»äº†è§£ä»–äººç¼–å†™çš„æ¨¡å—å¦‚ä½•è°ƒç”¨ï¼Œå¯¹è±¡æ˜¯å•¥ï¼Œåˆå§‹åŒ–æ–¹å¼æ˜¯å•¥ï¼Œè¿™è¿èƒŒäº†é¢å‘å¯¹è±¡çš„å°è£…åŸåˆ™
2. å¼•å…¥ä¸åŒçš„æ¨¡å—å¤´æ–‡ä»¶ï¼Œå¤šäº†ä»¥åï¼Œæ‰€ä¾èµ–çš„å¤–éƒ¨å‘ç”Ÿä¸€ä¸ç‚¹å˜åŒ–ä½ å°±è¦è·Ÿç€å˜ï¼Œé€»è¾‘å˜å¾—è¶Šæ¥è¶Šè€¦åˆï¼Œä¸åˆ©äºç»´æŠ¤
3. è°ƒç”¨ä¸åŒæ¨¡å—è¦åå¤ä¸ä»–äººæ²Ÿé€šä¼ å‚ã€å›è°ƒæµç¨‹ã€æ¥å£å®šä¹‰ç­‰ç­‰ï¼Œæ²Ÿé€šæ•ˆç‡ä½ä¸‹
4. äº§å“æå‡ºå„ç§éœ€æ±‚ï¼Œä½†æ˜¯æˆ‘å†™çš„ä»£ç éƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œæ¥ä¸€ä¸ªé¡µé¢æˆ‘éœ€è¦å†™ä¸€äº›ç›¸åŒé€»è¾‘çš„ä»£ç ï¼Œè€Œä¸”äº§å“è¿˜æŠ±æ€¨æ¯æ¬¡åŠ ç›¸åŒçš„ä¸œè¥¿å°±è¦æ”¹ä»£ç å‘ç‰ˆï¼Œè¿™æ˜¾ç„¶ä¸èƒ½æ»¡è¶³å¤ç”¨çš„è¦æ±‚ã€‚

> **æ€»ç»“**:  
> 			ä¾èµ–å¤šã€è€¦åˆé«˜ã€å¤ç”¨ä½ã€‚  
> å¯æˆ‘ä»¬éƒ½çŸ¥é“æœ‰è¿™ä¹ˆå¥è¯å•Šï¼šé«˜å†…èšã€ä½è€¦åˆï¼ŒèŒè´£å•ä¸€é€»è¾‘æ¸…æ™°ã€‚  

#### è·¯ç”±å°±æ˜¯è§£å†³ä¸Šé¢çš„é—®é¢˜
æˆ‘ä»¬å·²ç»å‘ç°ä¾èµ–æ¯”è¾ƒå¤§æ˜¯å› ä¸ºè¦å¯¼å…¥å…¶ä»–æ¨¡å—çš„å¤´æ–‡ä»¶ï¼Œäº†è§£å…¶ä»–æ¨¡å—çš„é€»è¾‘å’Œå®šä¹‰ï¼Œå¦‚æœå¤šäº†ï¼Œä½ çš„ä»£ç ä¸­å¼•å…¥çš„å¤´æ–‡ä»¶æˆ–è€…å¯¼å…¥çš„åŒ…åè¶Šæ¥è¶Šå¤šï¼Œæ”¹ä¸€ä¸‹ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«å•Šã€‚å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ï¼š

![ç›¸äº’å¼•ç”¨](http://upload-images.jianshu.io/upload_images/24274-d398af92665112ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
ä¾èµ–çš„é—®é¢˜å¾ˆä¸¥é‡ï¼Œè¦æƒ³ç ´é™¤è¿™æ ·çš„ä¾èµ–ï¼Œæˆ‘ä»¬èƒ½æƒ³åˆ°çš„åŠæ³•å°±æ˜¯æ‰¾ä¸ªè°ƒåº¦ä¸­å¿ƒå»åšè¿™ä»¶äº‹ï¼Œå…¶å®å„ä¸ªä¸šåŠ¡æ¨¡å—å¹¶ä¸å…³å¿ƒå…¶ä»–æ¨¡å—å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“è¿™ä¸ªæ¨¡å—å¦‚ä½•è·å–ï¼Œæˆ‘åªå…³å¿ƒæ€ä¹ˆè°ƒç”¨å’Œåé¦ˆçš„ç»“æœï¼Œè€Œè¿™ä¸ªæœ‰äº†è°ƒåº¦ä¸­å¿ƒè¿™ä¸ªä¸œè¥¿ï¼Œæ¯ä¸ªæ¨¡å—ä¸éœ€è¦ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œåªéœ€è¦è°ƒåº¦ä¸­å¿ƒå…³å¿ƒæ¯ä¸ªæ¨¡å—çš„è°ƒåº¦ã€‚
![å¼•å…¥ä¸­ä»‹è€…](http://upload-images.jianshu.io/upload_images/24274-2fcf500ce35083a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æœ‰äº†Routeè¿™ä¸ªè°ƒåº¦ä¸­å¿ƒï¼Œæ¯ä¸ªæ¨¡å—å°±ä¸ç”¨å†™é‚£ä¹ˆå¤šé‡å¤çš„è€¦åˆä»£ç äº†ï¼Œä¹Ÿä¸éœ€è¦åœ¨å¯¼å…¥é‚£ä¹ˆå¤šå¤´æ–‡ä»¶äº†å’Œå¼•å…¥é‚£ä¹ˆå¤šåŒ…åäº†ï¼Œè¿™äº›è“è‰²çš„ç®­å¤´ä»£è¡¨ç€è°ƒç”¨æ–¹å¼ï¼Œå¦‚æœè°ƒç”¨æ–¹å¼å†ç»Ÿä¸€ä¸€ä¸‹ï¼Œæ²Ÿé€šæ•ˆç‡å°±æå‡ä¸Šå»äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç”¨ä¸€å¥—çº¦å®šå¥½çš„æ•°æ®åè®®æ¥ä»£æ›¿é‡å¤æ²Ÿé€šï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦é çº¦å®šå’Œåè®®æ¥æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚
> Tips:  
> 		å‘ç°é—®é¢˜è¿™ä¸ªç¯èŠ‚å¾ˆé‡è¦ï¼Œä½ åœ¨å·¥ä½œä¸­ç»å¸¸è¦åå¤åšçš„ï¼Œæµªè´¹æ—¶é—´çš„éƒ½æ˜¯éœ€è¦ä½ å»ä¼˜åŒ–å’ŒèŠ±å¤§åŠ›æ°”å»è§£å†³çš„ï¼Œä½œä¸ºä¸€ä¸ªä¸“ä¸šäººå£«ï¼Œä¸æ–­æ”¹è¿›ä½ çš„ä»£ç ï¼Œä¼˜åŒ–ä½ çš„å·¥ä½œæµç¨‹ï¼Œå¸¦åŠ¨å›¢é˜Ÿå‘å¥½çš„åä½œæ–¹å¼å»è½¬å‹ï¼Œè¿™æ˜¯ä¸“ä¸šäººå£«çš„ä¹ æƒ¯ï¼Œæ›´åº”è¯¥æˆä¸ºä½ çš„ä¹ æƒ¯ã€‚åŒæ—¶é’ˆå¯¹ä»£ç å­˜åœ¨çš„é—®é¢˜ï¼Œä¹Ÿè®¸ä½ ç»å¸¸ä¼šéšéšçº¦çº¦æ„Ÿåˆ°æœ‰é—®é¢˜ï¼Œå°±æ˜¯ä¸çŸ¥é“é—®é¢˜åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œé‚£ä¹ˆéœ€è¦é—®é—®è‡ªå·±æœ‰æ²¡æœ‰ä»¥ä¸‹æƒ…å†µï¼šå“ªäº›ä»£ç æ˜¯ç»å¸¸å†™ä¸”é‡å¤åº¦å¾ˆé«˜çš„ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥æŠ½è±¡å‡ºæ¥ï¼Ÿå“ªäº›ä»£ç éœ€è¦åå¤çš„å˜åŠ¨ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥åšæˆé…ç½®æˆ–è€…æ˜¯å®šä¹‰ä¸€å¥—æ•°æ®æ ¼å¼æ¥æ»¡è¶³åŠ¨æ€å…¼å®¹ï¼Ÿæœ‰æ²¡æœ‰ä¸€äº›ç°æˆçš„è®¾è®¡æ¨¡å¼å¯ä»¥è§£å†³è¿™äº›é—®é¢˜ï¼Ÿæ¯”æ–¹è¯´ï¼Œè°ƒåº¦ä¸­å¿ƒåˆ™ä½¿ç”¨çš„æ˜¯ä¸­ä»‹è€…æ¨¡å¼ã€‚æˆ‘è§è¿‡  

### ä¸ºå•¥è¦è¯´iOSè·¯ç”±å‘¢ï¼Ÿ
è·¯ç”±å±‚å…¶å®åœ¨é€»è¾‘åŠŸèƒ½ä¸Šçš„è®¾è®¡éƒ½æ˜¯ä¸€æ ·çš„ï¼Œ**å¾ˆå¤šäººæŠŠAppä¸­çš„è§†å›¾åˆ‡æ¢å½“åšæ˜¯è·¯ç”±ç»„ä»¶çš„åŠŸèƒ½èŒè´£**ï¼Œè¿™ç‚¹æˆ‘æŒå¦å®šæ€åº¦ï¼Œä»å•ä¸€èŒè´£è§’åº¦å’ŒMVCæ¡†æ¶åˆ†ææ¥çœ‹ï¼Œè§†å›¾åˆ‡æ¢å±äºViewä¸­çš„äº¤äº’é€»è¾‘å¹¶ä¸å±äºæ¶ˆæ¯ä¼ é€’æˆ–è€…æ˜¯äº‹ä»¶åˆ†å‘çš„èŒƒç•´ï¼Œä½†è·¯ç”±è¯·æ±‚ã€è§†å›¾è½¬åœºçš„å®ç°éƒ¨åˆ†ä¸Androidå¹³å°å’ŒiOSå¹³å°ä¸Šçš„å¯¼èˆªæœºåˆ¶æœ‰ç€éå¸¸ç´§å¯†çš„å…³ç³»ï¼ŒAndroidæ“ä½œç³»ç»Ÿæœ‰ç€å¤©ç„¶çš„æ¶æ„ä¼˜åŠ¿ï¼ŒIntentæœºåˆ¶å¯ä»¥ååŠ©åº”ç”¨é—´çš„äº¤äº’ä¸é€šè®¯ï¼Œæ˜¯å¯¹è°ƒç”¨ç»„ä»¶å’Œæ•°æ®ä¼ é€’çš„æè¿°ï¼Œæœ¬èº«è¿™ç§æœºåˆ¶å°±è§£é™¤äº†ä»£ç é€»è¾‘å’Œç•Œé¢ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œåªæœ‰æ•°æ®ä¾èµ–ã€‚è€ŒiOSçš„ç•Œé¢å¯¼èˆªå’Œè½¬åœºæœºåˆ¶åˆ™å¤§éƒ¨åˆ†ä¾èµ–UIç»„ä»¶å„è‡ªçš„å®ç°ï¼Œæ‰€ä»¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒiOSç«¯è·¯ç”±çš„å®ç°åˆ™æ¯”è¾ƒæœ‰ä»£è¡¨æ€§ã€‚
å…¶å®è¯´ç™½ä¸€ç‚¹ï¼Œè·¯ç”±å±‚è§£å†³çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯åŸæ¥ç•Œé¢æˆ–è€…ç»„ä»¶ä¹‹é—´ç›¸äº’è°ƒç”¨éƒ½å¿…é¡»ç›¸äº’ä¾èµ–ï¼Œéœ€è¦å¯¼å…¥ç›®æ ‡çš„å¤´æ–‡ä»¶ã€éœ€è¦æ¸…æ¥šç›®æ ‡å¯¹è±¡çš„é€»è¾‘ï¼Œè€Œç°åœ¨å…¨éƒ¨éƒ½é€šè¿‡è·¯ç”±ä¸­è½¬ï¼Œåªä¾èµ–è·¯ç”±æˆ–è€…æŸç§é€šè®¯åè®®ï¼Œæˆ–è€…ä¾é ä¸€äº›æ¶ˆæ¯ä¼ é€’æœºåˆ¶è¿è·¯ç”±éƒ½ä¸ä¾èµ–ã€‚å…¶æ¬¡ï¼Œè·¯ç”±çš„æ ¸å¿ƒé€»è¾‘å°±æ˜¯ç›®æ ‡åŒ¹é…ï¼Œå¯¹äºå¤–éƒ¨è°ƒç”¨çš„æƒ…å†µæ¥è¯´ï¼ŒURLå¦‚ä½•åŒ¹é…Handleræ˜¯æœ€ä¸ºé‡è¦çš„ï¼ŒåŒ¹é…å°±å¿…ç„¶ç”¨åˆ°æ­£åˆ™è¡¨è¾¾å¼ã€‚äº†è§£è¿™äº›å…³é”®ç‚¹ä»¥åå°±æœ‰äº†è®¾è®¡çš„ç›®çš„æ€§ï¼Œletâ€˜s do it~

### æ€»ç»“ä¸€ä¸‹è¿™ä¸ªè·¯ç”±éƒ½è¦æœ‰ä»€ä¹ˆï¼Ÿ(éœ€æ±‚åˆ†æ)
æˆ‘ä»¬å…ˆæ ¹æ®ä¸Šé¢çš„æ¨¡ç³Šçš„æ€»ç»“æ¢³ç†ä¸€ä¸‹ï¼š
1. è·¯ç”±éœ€è¦èƒ½å¤Ÿå®ç°è¢«å…¶ä»–æ¨¡å—è°ƒåº¦ï¼Œä»è€Œè°ƒåº¦å¦å¤–ä¸€ä¸ªæ¨¡å—
2. æ¥å…¥è·¯ç”±çš„æ¨¡å—ä¸éœ€è¦çŸ¥é“ç›®æ ‡æ¨¡å—çš„å®ç°
3. è°ƒåº¦å‘èµ·æ–¹éœ€è¦æœ‰ç›®æ ‡çš„å“åº”å›è°ƒï¼Œç±»ä¼¼äºhttpè¯·æ±‚ï¼Œæœ‰ä¸€ä¸ªrequestå°±è¦æœ‰ä¸€ä¸ªresponseï¼Œæ‰èƒ½å®ç°åŒå‘çš„è°ƒç”¨
4. è°ƒç”¨æ–¹å¼éœ€è¦ç»Ÿä¸€ï¼Œç»Ÿä¸€è€Œæ¾æ•£çš„è°ƒç”¨åè®®å’Œæ•°æ®åè®®å¯ä»¥å‡å°‘å¤§é‡æ¥å…¥æˆæœ¬å’Œæ²Ÿé€šæˆæœ¬
é‚£ä¸€ä¸ªå®Œæ•´çš„è°ƒåº¦æµç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

![Routeæµç¨‹](http://upload-images.jianshu.io/upload_images/24274-13d08094246bf752.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
çœ‹åˆ°è¿™ä¸ªæµç¨‹ä»¥åï¼Œå¯ä»¥ç¡®å®šä»¥ä¸‹å‡ ä»¶äº‹ï¼š
1. Aæ¨¡å—è°ƒç”¨è·¯ç”±ï¼Œä¸ºè¡¨è¾¾è‡ªå·±éœ€è¦è°ƒç”¨çš„æ˜¯Bæ¨¡å—ï¼Œè€ƒè™‘åˆ°H5ã€æ¨é€ä»¥åŠå…¶ä»–Appçš„å¤–éƒ¨è°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨URLè¿™ç§æ–¹å¼æ¥å®šä¹‰ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨URLæ¥è¡¨ç¤ºç›®æ ‡B
2. å¯¹ä¸€ä¸ªURLçš„è¯·æ±‚æ¥è¯´ï¼Œè·¯ç”±éœ€è¦æœ‰ç»Ÿä¸€çš„å›è°ƒå¤„ç†ï¼Œå½“ç„¶ï¼Œå¦‚æœä¸éœ€è¦å›è°ƒä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå›è°ƒæ˜¯éœ€è¦ç›®æ ‡å»è§¦å‘çš„
3. è·¯ç”±è¦æœ‰å¤„ç†URLçš„åŠŸèƒ½ï¼Œå¹¶è°ƒç”¨å…¶ä»–æ¨¡å—çš„èƒ½åŠ›

æ ¹æ®ä»¥ä¸Šç²—ç•¥çš„å®šä¹‰ä¸€ä¸‹è·¯ç”±çš„æ¡†æ¶ï¼š

![æ¡†æ¶ç±»å›¾](http://upload-images.jianshu.io/upload_images/24274-e7fe7fcb1e60e042.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
è¿™é‡Œé¢ä»¥ä¾›æœ‰4éƒ¨åˆ†ï¼š
 WLRRouterå°±æ˜¯ä¸€ä¸ªå®ä½“å¯¹è±¡ï¼Œç”¨æ¥æä¾›ç»™å…¶ä»–æ¨¡å—è°ƒç”¨ã€‚
WLRRouteRequestæ˜¯ä¸€ä¸ªä»¥URLä¸ºåŸºç¡€çš„å®ä½“å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨URLå­—ç¬¦ä¸²ï¼Ÿå› ä¸ºè€ƒè™‘åˆ°å¦‚æœè·¯ç”±åœ¨å†…éƒ¨è°ƒç”¨å…¶ä»–æ¨¡å—çš„æ—¶å€™éœ€è¦ä¼ å…¥ä¸€äº›åŸç”Ÿå¯¹è±¡ï¼Œè€ŒURLä¸Šåªèƒ½æºå¸¦ç±»å‹å•ä¸€çš„å­—ç¬¦ä¸²é”®å€¼å¯¹è¡¨ç¤ºå‚æ•°ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨è¿™ä¹ˆä¸€ä¸ªå¯¹è±¡è¿›è¡ŒåŒ…è£…ã€‚
WLRRouteHandleræ˜¯ä¸€ä¸ªå¤„ç†æŸä¸€ä¸ªWLRRouteRequestè¯·æ±‚çš„å¯¹è±¡ï¼Œå½“è·¯ç”±æ¥æ”¶ä¸€ä¸ªWLRRouteRequestè¯·æ±‚ï¼Œè½¬å‘ç»™ä¸€ä¸ªWLRRouteHandlerå¤„ç†ï¼Œå¤„ç†å®Œæ¯•ä»¥åå¦‚æœæœ‰å›è°ƒï¼Œåˆ™å›è°ƒç»™è°ƒç”¨è€…ã€‚URLçš„è¯·æ±‚ä¸Handlerçš„å¯¹åº”å…³ç³»è‚¯å®šéœ€è¦åŒ¹é…çš„é€»è¾‘ï¼Œä¸ºäº†ä½¿å¾—è·¯ç”±å†…éƒ¨é€»è¾‘æ›´åŠ æ¸…æ™°å•ç‹¬ä½¿ç”¨WLRRouteMatcheræ¥å¤„ç†åŒ¹é…çš„é€»è¾‘ã€‚
### æ·±å…¥å…·ä½“éœ€æ±‚ï¼Œç»†åŒ–åŠŸèƒ½å®ç°(è¯¦ç»†è®¾è®¡)
æœ‰äº†ç²—ç•¥çš„éœ€æ±‚åˆ†ææ¥ä¸‹æ¥å°±æ˜¯ç»†åŒ–éœ€æ±‚å¹¶ç»™å‡ºè¯¦ç»†è®¾è®¡çš„é˜¶æ®µäº†ï¼Œå…¶å®ç¼–å†™ä¸€ä¸ªæ¨¡å—è¦æœ‰ç³»ç»Ÿæ€§æ€ç»´ï¼Œç²—ç•¥çš„éœ€æ±‚é‡Œé¢åŒ…å«äº†æ•´ä¸ªæ¨¡å—è¦å®ç°çš„ä¸»è¦æ ¸å¿ƒåŠŸèƒ½ï¼Œæ ¸å¿ƒæµç¨‹æ˜¯ä»€ä¹ˆï¼Œè¦æœ‰å“ªå‡ ä¸ªç±»æ‰èƒ½å®ç°è¿™æ ·çš„æµç¨‹ï¼Œä¸è¦å¦„å›¾ä¸€ä¸‹å­æ·±å…¥åˆ°ç»†ææœ«èŠ‚ä¸Šï¼Œè®©ç»†èŠ‚å·¦å³å®è§‚ä¸Šçš„é€»è¾‘æ¶æ„ï¼Œå¤§è„‘ä¸é€‚åˆåŒæ—¶è€ƒè™‘å®è§‚å’Œå¾®è§‚çš„äº‹æƒ…ï¼Œå°¤å…¶æ˜¯å¯¹ç»éªŒä¸å¤ªè¶³çš„å¼€å‘è€…æ¥è¯´ï¼Œè¦é€æ¸å­¦ä¼šå¤§è„‘åœ¨ä¸åŒçš„æ—¶æœŸè¿›è¡Œå®è§‚å’Œå¾®è§‚çš„æ— ç¼åˆ‡æ¢ï¼Œè¿™æ ·æ‰èƒ½ä¸“æ³¨ç›®æ ‡å’Œç»“æœï¼Œåœ¨å®ç°è¿‡ç¨‹ä¸­å†æŠ•å…¥å…¨éƒ¨ç²¾åŠ›è€ƒè™‘ç»†èŠ‚ï¼Œæ‰èƒ½ä¿è¯å…·ä½“çš„å®ç°æ˜¯ä¸åç¦»æ€»ä½“ç›®æ ‡çš„ã€‚
#### WLRRouteRequestè®¾è®¡
è·¯ç”±å±‚çš„è¯·æ±‚ï¼Œæ— è®ºæ˜¯è·¨åº”ç”¨çš„å¤–éƒ¨è°ƒç”¨(H5è°ƒç”¨ã€å…¶ä»–Appè°ƒç”¨)è¿˜æ˜¯å†…éƒ¨è°ƒç”¨(å†…éƒ¨æ¨¡å—ç›¸äº’è°ƒç”¨)ï¼Œæœ€åéƒ½è¦å½¢æˆä¸€ä¸ªè·¯ç”±è¯·æ±‚ï¼Œä¸€ä¸ªä»¥URLä¸ºåŸºç¡€çš„requestå¯¹è±¡ï¼Œé¦–å…ˆéœ€è¦æœ‰æºå¸¦URLï¼Œå†ä¸€ä¸ªè¦æºå¸¦è¯·æ±‚æ‰€éœ€è¦çš„å‚æ•°ï¼Œå‚æ•°æœ‰ä¸‰ç§ï¼Œä¸€ç§æ˜¯Urlä¸Šçš„é”®å€¼å¯¹å‚æ•°ï¼Œä¸€ç§æ˜¯RESTFulé£æ ¼çš„Urlä¸Šçš„è·¯å¾„å‚æ•°ï¼Œä¸€ç§æ˜¯å†…éƒ¨è°ƒç”¨é€‚ç”¨çš„åŸç”Ÿå‚æ•°ï¼Œå…·ä½“æ˜¯:

![WLRRouteRequest](http://upload-images.jianshu.io/upload_images/24274-60abc3355f7eb43a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
è¿™é‡Œè¯´ä¸€ä¸‹è·¯å¾„å‚æ•°ï¼Œå¾ˆå¤šæœ‰åç«¯å¼€å‘ç»éªŒçš„äººéƒ½çŸ¥é“ï¼Œä¸€ä¸ªurlä¸Šä¼ é€’å‚æ•°ï¼Œæˆ–è€…æ˜¯åŒ¹é…åç«¯æœåŠ¡çš„serviceï¼ŒUrlçš„è·¯å¾„å¯¹äºè¡¨è¾¾è½¬å‘è¯­ä¹‰ååˆ†é‡è¦ï¼Œæ¯”æ–¹è¯´ :
http://aaaa.com/login
http://aaaa.com/userCenter
é‚£Urlä¸­çš„loginå’ŒuserCenterå¯ä»¥ä»£è¡¨æ˜¯å“ªä¸ªåç«¯æœåŠ¡ï¼Œé‚£è·¯ç”±å°±éœ€è¦è®¾ç½®æ­£åˆ™åŒ¹é…è¡¨è¾¾å¼å»åŒ¹é…http://aaaa.com/ è¿™éƒ¨åˆ†ï¼Œæˆªå–loginã€userCenteréƒ¨åˆ†ï¼Œè¯´å›æˆ‘ä»¬çš„è·¯ç”±ï¼ŒAppçš„è·¯ç”±éœ€è¦é€šè¿‡è®¾ç½®Urlçš„æ­£åˆ™è¡¨è¾¾å¼æ¥è·å–è·¯å¾„å‚æ•°ï¼ŒåŒæ—¶æˆ‘ä»¬å¿…é¡»çŸ¥é“è¿™äº›å‚æ•°çš„å€¼å’Œåç§°ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥è¿™æ ·å®šä¹‰UrlåŒ¹é…çš„è¡¨è¾¾å¼
scheme://host/path/:name([a-zA-Z_-]+)
ç†Ÿæ‚‰æ­£åˆ™è¡¨è¾¾å¼çš„å­©å­éƒ½çŸ¥é“åˆ†ç»„æ¨¡å¼ï¼Œpathånameæ˜¯keyï¼Œ([a-zA-Z_-]+)æ˜¯è§„å®šnameå¯¹åº”çš„valueåº”è¯¥æ˜¯ä»€ä¹ˆæ ¼å¼çš„ã€‚é‚£ä¹ˆrouteParameterså°±æ˜¯å­˜æ”¾è·¯å¾„å‚æ•°çš„

```
//url
@property (nonatomic, copy, readonly) NSURL *URL;
//urlä¸Šï¼Ÿä»¥åçš„é”®å€¼å¯¹å‚æ•°
@property (nonatomic, copy, readonly) NSDictionary *queryParameters;
//urlä¸ŠåŒ¹é…çš„è·¯å¾„å‚æ•°
@property (nonatomic, copy, readonly) NSDictionary *routeParameters;
//åŸç”Ÿå‚æ•°ï¼Œæ¯”æ–¹è¯´è¦ä¼ ç»™ç›®æ ‡UIImageå¯¹è±¡ï¼ŒNSArrayå¯¹è±¡ç­‰ç­‰
@property (nonatomic, copy, readonly) NSDictionary *primitiveParams;
//ç›®æ ‡é¢„ç•™çš„callBack block,å½“å®Œæˆå¤„ç†ä»¥å,å›åˆ°æ­¤Blockï¼Œå®Œæˆè°ƒç”¨è€…çš„å›è°ƒ
@property(nonatomic,copy)void(^targetCallBack)(NSError *error,id responseObject);
//æ˜¯å¦æ¶ˆè´¹æ‰ï¼Œä¸€ä¸ªrequeståªèƒ½å¤„ç†ä¸€æ¬¡ï¼Œè¯¥å­—æ®µååº”requestæ˜¯å¦è¢«å¤„ç†è¿‡
@property(nonatomic)BOOL isConsumed;
```
#### WLRRouteHandlerè®¾è®¡
handlerå¯¹è±¡è¦æ¥æ”¶ä¸€ä¸ªWLRRouteRequestå¯¹è±¡æ¥å¯åŠ¨å¤„ç†æµç¨‹ï¼Œå‰é¢ç»è¿‡æˆ‘ä»¬çš„åˆ†æï¼Œè¿™ä¸ªhandleråº”è¯¥æ‹…è´Ÿèµ·é€šè¿‡urlå’Œå‚æ•°è·å–ç›®æ ‡å¯¹è±¡çš„èŒè´£ï¼Œåœ¨ä¸€èˆ¬çš„routeå¤„ç†ä¸­ï¼Œç›®æ ‡å¾€å¾€æ˜¯ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼Œå…ˆå®ç°è¿™æ ·ä¸€ä¸ªé€šè¿‡urlè°ƒç”¨æŸä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨çš„å¹¶è·³è½¬å¤„ç†çš„handlerï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯å¦‚ä¸‹çš„ï¼š

![WLRRouteHandler](http://upload-images.jianshu.io/upload_images/24274-523fb9fac7c05dad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
handlerå¤„ç†ä¸€ä¸ªrequestè¯·æ±‚æ˜¯ä¸€ä¸ªå…·æœ‰è¿‡ç¨‹æ€§çš„é€»è¾‘ï¼ŒWLRRouteHandlerè¦ä½œä¸ºä¸€ä¸ªåŸºç±»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œè¿™ä¸ªhandleråœ¨éœ€è¦å¤„ç†è·å–ç›®æ ‡è§†å›¾æ§åˆ¶å™¨->å‚æ•°ä¼ é€’ç»™ç›®æ ‡è§†å›¾æ§åˆ¶å™¨->è§†å›¾æ§åˆ¶å™¨çš„è½¬åœº->å®Œæˆå›è°ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è®¾è®¡è¿™æ ·çš„æ¥å£

```
//å³å°†å¼€å§‹å¤„ç†requestè¯·æ±‚ï¼Œè¿”å›å€¼å†³å®šæ˜¯å¦è¦ç»§ç»­ç›¸åº”request
- (BOOL)shouldHandleWithRequest:(WLRRouteRequest *)request;
//å¼€å§‹å¤„ç†requestè¯·æ±‚
-(BOOL)handleRequest:(WLRRouteRequest *)request error:(NSError *__autoreleasing *)error;
// æ ¹æ®requestè·å–ç›®æ ‡æ§åˆ¶å™¨
-(UIViewController *)targetViewControllerWithRequest:(WLRRouteRequest *)request;
//è½¬åœºä¸€å®šæ˜¯ä»ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼Œè¯¥æ–¹æ³•ç”¨ä»¥è·å–è½¬åœºä¸­çš„æºè§†å›¾æ§åˆ¶å™¨
-(UIViewController *)sourceViewControllerForTransitionWithRequest:(WLRRouteRequest *)request;
//æ”¹æ–¹æ³•å†…æ ¹æ®requestã€è·å–çš„ç›®æ ‡å’Œæºè§†å›¾æ§åˆ¶å™¨ï¼Œå®Œæˆè½¬åœºé€»è¾‘
-(BOOL)transitionWithWithRequest:(WLRRouteRequest *)request sourceViewController:(UIViewController *)sourceViewController targetViewController:(UIViewController *)targetViewController isPreferModal:(BOOL)isPreferModal error:(NSError *__autoreleasing *)error;
//æ ¹æ®requestæ¥è¿”å›æ˜¯å¦æ˜¯æ¨¡æ€è·³è½¬
- (BOOL)preferModalPresentationWithRequest:(WLRRouteRequest *)request;
```
#### WLRRouteMatcherè®¾è®¡
ä¸€ä¸ªmatcheråº”è¯¥å…·æœ‰æ ¹æ®urlå’Œå‚æ•°åˆ¤æ–­æ˜¯å¦åŒ¹é…æŸä¸ªurlè¡¨è¾¾å¼çš„é€»è¾‘
 
![WLRRouteMatcher](http://upload-images.jianshu.io/upload_images/24274-912c748a2956cce0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
matcherå¯¹è±¡å¿…é¡»æ‹¥æœ‰urlçš„åŒ¹é…è¡¨è¾¾å¼ï¼Œç±»ä¼¼äº scheme://host/path/:name([a-zA-Z_-]+) ï¼Œä¹Ÿæœ‰æ‹¥æœ‰è¯¥è¡¨è¾¾å¼çœŸæ­£çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œ^scheme://host/path/([a-zA-Z_-]+)$ 

```
@interface WLRRouteMatcher : NSObject
//urlåŒ¹é…è¡¨è¾¾å¼
@property(nonatomic,copy)NSString * routeExpressionPattern;
//urlåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼
@property(nonatomic,copy)NSString * originalRouteExpression;
+(instancetype)matcherWithRouteExpression:(NSString *)expression;
-(WLRRouteRequest *)createRequestWithURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError *, id responseObject))targetCallBack;
```

è®¾è®¡`-(WLRRouteRequest *)createRequestWithURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError *, id responseObject))targetCallBack;`è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡ä¼ å…¥urlå’Œå‚æ•°ï¼Œæ£€æŸ¥æ˜¯å¦è¿”å›requestè¯·æ±‚ï¼Œæ¥è¡¨ç¤ºè¯¥WLRRouteMatcherå¯¹è±¡æ‰€æ‹¥æœ‰çš„åŒ¹é…è¡¨è¾¾å¼ä¸urlæ˜¯å¦èƒ½å¤ŸåŒ¹é…ï¼Œè¿™å¥è¯æœ‰ç‚¹ç»•ï¼Œçœ‹ä¸æ‡‚çš„å¤šçœ‹å‡ éã€‚
#### WLRRouter
WLRRouteræ˜¯è·¯ç”±å®ä½“å¯¹è±¡ï¼Œåç«¯å¼€å‘è€…å¯¹äºè·¯ç”±æŒ‚è½½çš„æ¦‚å¿µéå¸¸äº†è§£ï¼Œå…¶å®è¿™æ ·ä¸€ä¸ªè·¯ç”±å®ä½“å¯¹è±¡å¯ä»¥å®Œæˆå¯¹URLçš„æ‹¦æˆªå’Œå¤„ç†å¹¶è¿”å›ç»“æœï¼Œäº‹å®ä¸Šï¼Œæ ¹æ®å‰é¢çš„æ¢³ç†å’Œæ€»ç»“ï¼ŒWLRRouterå¯¹è±¡å†…éƒ¨åº”è¯¥ä¿å­˜äº†éœ€è¦åŒ¹é…æ‹¦æˆªçš„URLè¡¨è¾¾å¼ï¼Œè€Œå‰é¢æˆ‘ä»¬çŸ¥é“Urlçš„åŒ¹é…è¡¨è¾¾å¼æ˜¯å­˜å‚¨åœ¨WLRRouteMatcherå¯¹è±¡ä¸­çš„ï¼Œå¹¶ä¸”ä¸€ä¸ªUrlä¼ å…¥æ£€æŸ¥æ˜¯å¦åŒ¹é…ä¹Ÿæ˜¯Matcherå¯¹è±¡æä¾›çš„åŠŸèƒ½ï¼Œå¯¹äºåŒ¹é…ä¸Šçš„Urléœ€è¦æœ‰å¯¹åº”çš„Handlerå¤„ç†ï¼Œæ‰€ä»¥Routerå¯¹è±¡çš„å†…éƒ¨å­˜åœ¨Machterå¯¹è±¡å’ŒHandlerå¯¹è±¡ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œå¹¶ä¸”æ‹¥æœ‰æ³¨å†ŒUrlè¡¨è¾¾å¼å¯¹åº”åˆ°Handlerçš„åŠŸèƒ½ï¼Œä¹Ÿå…·æœ‰ä¼ å…¥Urlå’Œå‚æ•°å°±èƒ½åŒ¹é…åˆ°Handlerçš„åŠŸèƒ½ï¼Œè¿˜è¦æœ‰ä¸€ä¸ªæ£€æµ‹Urlæ˜¯å¦èƒ½æœ‰å¯¹åº”Handlerå¤„ç†çš„åŠŸèƒ½ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ï¼š

![WLRRouter](http://upload-images.jianshu.io/upload_images/24274-7f26732da4732db5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
è¿™é‡Œæœ‰ä¸¤ç§æ³¨å†Œçš„æ–¹æ³•ï¼Œæ³¨å†Œhandlerçš„å°±ä¸éœ€å†å¤šæè¿°ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æ³¨å†ŒBlockçš„å›è°ƒå½¢å¼ï¼Œå› ä¸ºæœ‰æ—¶å€™å¯èƒ½ä¼šéœ€è¦ä¸€äº›ç®€å•çš„Urlæ‹¦æˆªï¼Œå»åšä¸€äº›äº‹æƒ…ï¼Œè¿™é‡Œé¢çš„Blockéœ€è¦è¿”å›ä¸€ä¸ªrequestå¯¹è±¡ï¼Œè¿™æ˜¯å› ä¸ºï¼Œå¦‚æœBlockæ²¡æœ‰å¯¹requestçš„å›è°ƒåšå¤„ç†ï¼ŒRouteråº”è¯¥å¤„ç†è°ƒç”¨è€…çš„å›è°ƒé—®é¢˜ï¼Œå¦åˆ™å°±ä¼šå‡ºç°è°ƒç”¨è€…è®¾ç½®äº†å›è°ƒçš„Blockè€Œæ²¡æœ‰äººè°ƒç”¨å›æ¥ï¼Œè¿™æ ·å°±å°´å°¬äº†ã€‚

```
/**
 æ³¨å†Œä¸€ä¸ªrouteè¡¨è¾¾å¼å¹¶ä¸ä¸€ä¸ªblockå¤„ç†ç›¸å…³è”
 
 @param routeHandlerBlock blockç”¨ä»¥å¤„ç†åŒ¹é…routeè¡¨è¾¾å¼çš„urlçš„è¯·æ±‚
 @param route urlçš„è·¯ç”±è¡¨è¾¾å¼ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åˆ†ç»„ï¼Œä¾‹å¦‚app://login/:phone({0,9+})æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œ:phoneä»£è¡¨è¯¥è·¯å¾„å€¼å¯¹åº”çš„key,å¯ä»¥åœ¨WLRRouteRequestå¯¹è±¡ä¸­çš„routeParametersä¸­è·å–
 */
-(void)registerBlock:(WLRRouteRequest *(^)(WLRRouteRequest * request))routeHandlerBlock forRoute:(NSString *)route;
/**
 æ³¨å†Œä¸€ä¸ªrouteè¡¨è¾¾å¼å¹¶ä¸ä¸€ä¸ªblockå¤„ç†ç›¸å…³è”
 
 @param routeHandlerBlock handlerå¯¹è±¡ç”¨ä»¥å¤„ç†åŒ¹é…routeè¡¨è¾¾å¼çš„urlçš„è¯·æ±‚
 @param route urlçš„è·¯ç”±è¡¨è¾¾å¼ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„åˆ†ç»„ï¼Œä¾‹å¦‚app://login/:phone({0,9+})æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œ:phoneä»£è¡¨è¯¥è·¯å¾„å€¼å¯¹åº”çš„key,å¯ä»¥åœ¨WLRRouteRequestå¯¹è±¡ä¸­çš„routeParametersä¸­è·å–
 */
-(void)registerHandler:(WLRRouteHandler *)handler forRoute:(NSString *)route;

/**
 æ£€æµ‹urlæ˜¯å¦èƒ½å¤Ÿè¢«å¤„ç†ï¼Œä¸åŒ…å«ä¸­é—´ä»¶çš„æ£€æŸ¥

 @param url è¯·æ±‚çš„url
 @return æ˜¯å¦å¯ä»¥handle
 */
-(BOOL)canHandleWithURL:(NSURL *)url;
/**
 å¤„ç†urlè¯·æ±‚

 @param URL è°ƒç”¨çš„url
 @param primitiveParameters æºå¸¦çš„åŸç”Ÿå¯¹è±¡
 @param targetCallBack ä¼ ç»™ç›®æ ‡å¯¹è±¡çš„å›è°ƒblock
 @param completionBlock å®Œæˆè·¯ç”±ä¸­è½¬çš„block
 @return æ˜¯å¦èƒ½å¤Ÿhandle
 */
-(BOOL)handleURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError *, id responseObject))targetCallBack withCompletionBlock:(void(^)(BOOL handled, NSError *error))completionBlock;
```
#### æ¢³ç†æ€»ç»“ï¼š
ä»ä»¥ä¸Šæˆ‘ä»¬è§„åˆ’çš„å‡ ä¸ªç±»çš„æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°Routerå·¥ä½œçš„æµç¨‹ã€‚
1. é¦–å…ˆå®ä¾‹åŒ–Routerå¯¹è±¡
2. å®ä¾‹åŒ–Handleræˆ–è€…æ˜¯Blockï¼Œé€šè¿‡Routerçš„æ³¨å†Œæ¥å£ä½¿å¾—ä¸€ä¸ªUrlçš„åŒ¹é…è¡¨è¾¾å¼å¯¹åº”ä¸€ä¸ªHandleræˆ–è€…æ˜¯ä¸€ä¸ªblock
3. Routerå†…éƒ¨ä¼šå°†Urlçš„è¡¨è¾¾å¼å½¢æˆä¸€ä¸ªMatcherå¯¹è±¡è¿›è¡Œä¿å­˜ï¼Œå¯¹åº”çš„Handleræˆ–å¤„ç†çš„Blockä¼šä¸Matcherä¸€ä¸€å¯¹åº”ï¼Œæ€ä¹ˆå¯¹åº”å‘¢ï¼Ÿåº”è¯¥ä½¿ç”¨è·¯ç”±è¡¨è¾¾å¼è¿›è¡Œå…³è”
4. Routeré€šè¿‡handleæ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ªUrlçš„è¯·æ±‚ï¼Œå†…éƒ¨éå†æ‰€æœ‰çš„Matcherå¯¹è±¡ï¼Œå°†Urlå’Œå‚æ•°è½¬æ¢ä¸ºRequestå¯¹è±¡ï¼Œå¦‚æœèƒ½è½¬æ¢ä¸ºRequestå¯¹è±¡åˆ™è¯´æ˜èƒ½åŒ¹é…ï¼Œå¦‚æœä¸èƒ½åˆ™è¯´æ˜è¯¥Urlä¸èƒ½è¢«è·¯ç”±å®ä½“å¤„ç†
5. æ‹¿åˆ°Requestå¯¹è±¡ä»¥åï¼Œåˆ™æ ¹æ®Matcherå¯¹åº”çš„è·¯ç”±è¡¨è¾¾å¼æ‰¾åˆ°å¯¹åº”çš„Handleræˆ–è€…æ˜¯Block
6. æ ¹æ®Handlerçš„å‡ ä¸ªå…³é”®æ–¹æ³•ï¼Œä¼ å…¥Requestå¯¹è±¡ï¼ŒæŒ‰ç…§é¡ºåºå®Œæˆå¤„ç†é€»è¾‘çš„è§¦å‘ï¼Œæœ€åå¦‚æœæœ‰requestå½“ä¸­åŒ…å«æœ‰ç›®æ ‡çš„å›è°ƒï¼Œåˆ™å°†å¤„ç†ç»“æœé€šè¿‡å›è°ƒçš„Blockå“åº”ç»™è°ƒç”¨æ–¹
7. Handlerå®Œæˆå¤„ç†åï¼ŒRouterå®Œæˆæœ¬æ¬¡è·¯ç”±è¯·æ±‚

![WLRRoute](http://upload-images.jianshu.io/upload_images/24274-9fde2e0d062806bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
> Tips:  
> å¾ˆå¤šå¼€å‘è€…æŠŠæ•æ·å¼€å‘å½“åšæ¥äº†éœ€æ±‚ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œä¸€æŠŠæ¢­å­å°±æ˜¯å¹²ï¼Œä¸æ–­å†™ä¸æ–­æ”¹ã€‚ğŸ™Šå…¶å®æ•æ·å¼€å‘æ˜¯ä¸€ç§æ¨¡å¼ï¼Œå¹¶ä¸ç®€å•æ˜¯å¿«é€Ÿè¿­ä»£çš„æ„æ€ã€‚åˆå…¥è¡Œçš„ç¨‹åºå‘˜å…¶å®éƒ½æ˜¯coder(ç¼–ç å‘˜)ï¼ŒåŸºæœ¬ä¸Šåœ¨é æ¨¡ä»¿ä»£ç å’Œä»£ç å¥—è·¯å»å·¥ä½œï¼ŒçœŸæ­£çš„Programmer(ç¨‹åºè®¾è®¡å¸ˆ)æ˜¯åœ¨è®¾è®¡ä»£ç ï¼Œç§‘ç­å‡ºèº«çš„ç¨‹åºå‘˜å¾€å¾€åœ¨è¿›é˜¶è¿‡ç¨‹ä¸­çªç„¶å‘ç°å¤§å­¦é‡Œé¢çš„è½¯ä»¶å·¥ç¨‹æœ‰å¤šä¹ˆé‡è¦ï¼Œå…¶å®è®¾è®¡èƒ½åŠ›çš„åŸ¹å…»éœ€è¦æœ‰ä¸€ä¸ªæ­£è§„çš„æµç¨‹ï¼Œå°±åƒæœ¬æ•™ç¨‹çš„å¤§çº²ä¸€æ ·ï¼Œå‘ç°é—®é¢˜->éœ€æ±‚åˆ†æ->æ€»ä½“è®¾è®¡->å…·ä½“å®ç°->æµ‹è¯•->å‘å¸ƒç»´æŠ¤ï¼Œæœ‰äº†æ¸…æ™°çš„æµç¨‹ï¼ŒæŠŠä½ çš„ç²¾åŠ›å’Œæ—¶é—´æŒ‰ç…§ä¸åŒçš„é˜¶æ®µè¿›è¡Œåˆ†é…å’ŒæŠ•å…¥ï¼Œä½ å°±ä¼šè±ç„¶å¼€æœ—ï¼Œæ¯”æ–¹è¯´åœ¨æ€»ä½“è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œå°±éœ€è¦ä½ ä»¥å®è§‚çš„åŠŸèƒ½æµç¨‹å»è€ƒè™‘å¤§ä½“çš„æ¨¡å—æœ‰å‡ ä¸ªï¼Œæ¨¡å—çš„å…³ç³»æ˜¯æ€æ ·ï¼Œæ¯ä¸ªæ¨¡å—çš„æ ¸å¿ƒèŒè´£æ˜¯ä»€ä¹ˆï¼Œå»ºè®®æ ¹æ®éœ€æ±‚å»ç”»ä¸€ä¸ªé€»è¾‘æµç¨‹å›¾ï¼Œå°†æ¯ä¸ªé€»è¾‘åˆ†æ”¯éƒ½è¡¥å…¨ï¼Œå†æ ¹æ®æµç¨‹å›¾è§„åˆ’æ€»ä½“æ¡†æ¶ï¼Œæ€»ä½“æ¡†æ¶é€šè¿‡ç±»å›¾æ¥è¡¨è¾¾ï¼Œæ¯ä¸ªç±»çš„å±æ€§å’Œè¡Œä¸ºéƒ½ç¡®å®šä»¥åï¼Œå†è¿›å…¥å…·ä½“è®¾è®¡é˜¶æ®µå°±éå¸¸è½»æ¾å’Œå®¹æ˜“äº†ï¼ŒåŒæ—¶ç±»å›¾ç”»å®Œï¼ŒæŠ€æœ¯æ–¹æ¡ˆçš„å¯è¡Œæ€§å’Œå®ç°æ‰€éœ€æ—¶é—´ä¹Ÿå°±éå¸¸å®¹æ˜“ç²¾ç¡®è¯„ä¼°äº†  

### ç»™æ¶å­å¡«å……éª¨è¡€(å…·ä½“å®ç°)ï¼š
æœ‰äº†ä¸Šé¢å¤§ä½“ä¸Šçš„æ¶å­æˆ‘ä»¬å°±èƒ½ç›¸ä¿¡åªè¦æŒ‰ç…§è¿™ä¸ªæ¶å­ï¼Œå°±èƒ½å®Œæˆä½ åœ¨éœ€æ±‚åˆ†æé˜¶æ®µè§„åˆ’çš„åŠŸèƒ½ç›®æ ‡ï¼Œç°åœ¨æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨æˆ‘ä»¬è®¾è®¡çš„è¿™ä¸ªç‰›é€¼çš„æ¡†æ¶é‡Œå¡«å……è¡€è‚‰ï¼Œå»å®ç°å®ƒï¼Œè¿™éƒ¨åˆ†æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„è¿‡ç¨‹ï¼Œåœ¨ä¸Šä¸€æ­¥ä½ å·²ç»è·å¾—äº†ç›¸å½“å¤§çš„ä¿¡å¿ƒï¼Œåœ¨è¿™ä¸€æ­¥ä½ åªéœ€è¦æŒ‰ç…§è§„å®šå°½åŠ›å»å®ç°ï¼Œåœ¨æœ‰ä¿¡å¿ƒçš„æƒ…å†µä¸‹ï¼Œä½ ä¼šæ€ç»´æ´»è·ƒï¼Œå› ä¸ºä½ æ˜ç¡®äº†è¦å®ç°ä½•ç§åŠŸèƒ½çš„ç›®æ ‡ï¼Œå¤§è„‘ä¼šè‡ªåŠ¨æ ¹æ®ç›®æ ‡å’Œç°åœ¨å·®è·ä¸æ–­æƒ³è€ƒå‡ºå„ç§åŠæ³•å»å¼¥è¡¥è¿™æ ·çš„å·®è·ï¼Œä½ æ‰€åšçš„å°±æ˜¯ä¸æ–­å°è¯•ä½ å¤§è„‘è¿¸å‘å‡ºçš„è¿™äº›ä»£ç ï¼Œé€‰æ‹©æœ€æœ‰æ•ˆã€å¯è¯»æ€§æœ€å¥½ã€æ€§èƒ½æœ€å¥½å’Œä»£ç æœ€å¥å£®çš„ä»£ç ã€‚
####  WLRRouteRequest:
äº†è§£äº†ä»¥ä¸Šï¼Œæˆ‘ä»¬ä»WLRRouteRequestå…¥æ‰‹ã€‚
å…¶å®WLRRouteRequestè·ŸNSURLRequestå·®ä¸å¤šï¼Œä¸è¿‡WLRRouteRequestç»§æ‰¿NSObjectï¼Œå®ç°NSCopyingåè®®ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å¤´æ–‡ä»¶çš„å£°æ˜ï¼š

```
#import <Foundation/Foundation.h>

@interface WLRRouteRequest : NSObject<NSCopying>
//å¤–éƒ¨è°ƒç”¨çš„URL
@property (nonatomic, copy, readonly) NSURL *URL;
//URLè¡¨è¾¾å¼ï¼Œæ¯”æ–¹è¯´è°ƒç”¨ç™»å½•ç•Œé¢çš„è¡¨è¾¾å¼å¯ä»¥ä¸ºï¼šAppScheme://user/login/138********ï¼Œé‚£URLçš„åŒ¹é…è¡¨è¾¾å¼å¯ä»¥æ˜¯ï¼š/login/:phone([0-9]+),è·¯å¾„å¿…é¡»ä»¥/loginå¼€å¤´ï¼Œåé¢æ¥0-9çš„ç”µè¯å·ç æ•°å­—ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥æŠŠç”µè¯å·ç çš„æ­£åˆ™åŒ¹é…å†™å…¨
@property(nonatomic,copy)NSString * routeExpression;
//å¦‚æœURLæ˜¯AppScheme://user/login/138********?callBack="",é‚£ä¹ˆè¿™ä¸ªcallBackå°±å‡ºç°åœ¨è¿™
@property (nonatomic, copy, readonly) NSDictionary *queryParameters;
//è¿™é‡Œé¢ä¼šå‡ºç°{@"phone":@"138********"}
@property (nonatomic, copy, readonly) NSDictionary *routeParameters;
//è¿™é‡Œé¢å­˜æ”¾çš„æ˜¯å†…éƒ¨è°ƒç”¨ä¼ é€’çš„åŸç”Ÿå‚æ•°
@property (nonatomic, copy, readonly) NSDictionary *primitiveParams;
//è‡ªåŠ¨æ£€æµ‹çªƒå–å›è°ƒçš„callBack çš„Url
@property (nonatomic, strong) NSURL *callbackURL;
//ç›®æ ‡çš„viewcontrollleræˆ–è€…æ˜¯ç»„ä»¶å¯ä»¥é€šè¿‡è¿™ä¸ª
@property(nonatomic,copy)void(^targetCallBack)(NSError *error,id responseObject);
//ç”¨ä»¥è¡¨æ˜è¯¥requestæ˜¯å¦è¢«æ¶ˆè´¹
@property(nonatomic)BOOL isConsumed;
//ç®€ä¾¿æ–¹æ³•ï¼Œç”¨ä»¥ä¸‹æ ‡æ³•å–å‚æ•°
- (id)objectForKeyedSubscript:(NSString *)key;
//åˆå§‹åŒ–æ–¹æ³•
-(instancetype)initWithURL:(NSURL *)URL routeExpression:(NSString *)routeExpression routeParameters:(NSDictionary *)routeParameters primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError * error,id responseObject))targetCallBack;
-(instancetype)initWithURL:(NSURL *)URL;
//é»˜è®¤å®Œæˆç›®æ ‡çš„å›è°ƒ
-(void)defaultFinishTargetCallBack;
@end
```

åˆå§‹åŒ–æ–¹æ³•å°±æ˜¯å°†ä¸‰ä¸ªå­˜æ”¾å…¥å‚çš„å­—å…¸åˆå§‹åŒ–ï¼Œå¹¶ç›´æ¥å°†Urlä¸Šçš„ï¼Ÿä»¥åçš„å‚æ•°å–å‡ºæ¥ï¼š

```
-(instancetype)initWithURL:(NSURL *)URL{
    if (!URL) {
        return nil;
    }
    self = [super init];
    if (self) {
        _URL = URL;
        _queryParameters = [[_URL query] WLRParametersFromQueryString];
    }
    return self;
}
-(instancetype)initWithURL:(NSURL *)URL routeExpression:(NSString *)routeExpression routeParameters:(NSDictionary *)routeParameters primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void (^)(NSError *, id))targetCallBack{
    if (!URL) {
        return nil;
    }
    self = [super init];
    if (self) {
        _URL = URL;
        _queryParameters = [[_URL query] WLRParametersFromQueryString];
        _routeExpression = routeExpression;
        _routeParameters = routeParameters;
        _primitiveParams = primitiveParameters;
        self.targetCallBack = targetCallBack;
    }
    return self;
}
```
åœ¨è°ƒç”¨æ–¹è®¾ç½®ä¼ å…¥callBackçš„æ—¶å€™ï¼Œå› ä¸ºrequestæ˜¯æ¶ˆè´¹å‹çš„ï¼Œæ‰€ä»¥å°†TargetCallBacké‡æ–°åŒ…è£…ï¼Œåœ¨å›è°ƒçš„æ—¶å€™éœ€è¦å°†isConsumedå±æ€§è®¾ç½®ä¸ºYESï¼Œè¡¨ç¤ºè¯¥requestå·²ç»è¢«å¤„ç†æ¶ˆè€—ï¼Œè¿™é‡Œå®ç°çš„æ¯”è¾ƒç®€å•ï¼Œå…¶å®requestæ˜¯åº”è¯¥å…·æœ‰çŠ¶æ€çš„ï¼Œæ¯”æ–¹è¯´æœªå¤„ç†ï¼Œå¤„ç†ä¸­ï¼Œå·²å¤„ç†ï¼Œå®ç°ä¸€ä¸ªä¼˜é›…çš„çŠ¶æ€æœºä¼šæ›´å¥½çš„è¡¨è¾¾é€»è¾‘ï¼š
```
-(void)setTargetCallBack:(void (^)(NSError *, id))targetCallBack{
    __weak WLRRouteRequest * weakRequest = self;
    if (targetCallBack == nil) {
        return;
    }
    self.isConsumed = NO;
    _targetCallBack = ^(NSError *error, id responseObject){
        weakRequest.isConsumed = YES;
        targetCallBack(error,responseObject);
    };
    
}
```
é»˜è®¤çš„å›è°ƒæ–¹æ³•æ˜¯ä¸ºäº†å¤„ç†å“åº”è€…æ²¡æœ‰è§¦å‘å›è°ƒï¼Œåˆ™éœ€è¦æœ‰é»˜è®¤çš„å›è°ƒç»™è°ƒç”¨è€…ï¼š
```
-(void)defaultFinishTargetCallBack{
    if (self.targetCallBack && self.isConsumed == NO) {
        self.targetCallBack(nil,@"æ­£å¸¸æ‰§è¡Œå›è°ƒ");
    }
}
```
#### WLRRouteHandler
```
#import <Foundation/Foundation.h>
@class WLRRouteRequest;
@interface WLRRouteHandler : NSObject
//å³å°†handleæŸä¸€ä¸ªè¯·æ±‚
- (BOOL)shouldHandleWithRequest:(WLRRouteRequest *)request;
//æ ¹æ®requestå–å‡ºè°ƒç”¨çš„ç›®æ ‡è§†å›¾æ§åˆ¶å™¨
-(UIViewController *)targetViewControllerWithRequest:(WLRRouteRequest *)request;
//æ ¹æ®requestå–å‡ºæ¥æºçš„è§†å›¾æ§åˆ¶å™¨
-(UIViewController *)sourceViewControllerForTransitionWithRequest:(WLRRouteRequest *)request;
//å¼€å§‹è¿›è¡Œè½¬åœº
-(BOOL)transitionWithWithRequest:(WLRRouteRequest *)request sourceViewController:(UIViewController *)sourceViewController targetViewController:(UIViewController *)targetViewController isPreferModal:(BOOL)isPreferModal error:(NSError *__autoreleasing *)error;
//æ˜¯å¦æ¨¡æ€è·³è½¬
- (BOOL)preferModalPresentationWithRequest:(WLRRouteRequest *)request;
@end
```
å½“WLRRouterå¯¹è±¡å®Œæˆäº†URLçš„åŒ¹é…ç”ŸæˆRequestï¼Œå¹¶å¯»æ‰¾åˆ°Handlerçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè°ƒç”¨
```
-(BOOL)shouldHandleWithRequest:(WLRRouteRequest *)request{
    return YES;
}
```
å­ç±»å¯ä»¥è¦†å†™è¿™ä¸ªæ–¹æ³•ï¼Œå®ç°ä¸€äº›å‚æ•°æ£€æŸ¥æˆ–è€…å½“ç„¶AppçŠ¶æ€æ£€æŸ¥çš„å·¥ä½œï¼Œæ¯”æ–¹è¯´æ£€æµ‹å½“å‰ç•Œé¢æ˜¯å¦å·²ç»æœ‰æ¨¡æ€è·³è½¬è¦†ç›–çš„ç•Œé¢æˆ–è€…æ˜¯å¼¹çª—ä¹‹ç±»ï¼Œåšä¸€äº›æ¸…åœºå·¥ä½œæ¥ä¸ºæœ¬æ¬¡è½¬åœºè¿›è¡Œå‡†å¤‡ã€‚éšåè°ƒç”¨è°ƒç”¨:
```
-(BOOL)handleRequest:(WLRRouteRequest *)request error:(NSError *__autoreleasing *)error{
    UIViewController * sourceViewController = [self sourceViewControllerForTransitionWithRequest:request];
    UIViewController * targetViewController = [self targetViewControllerWithRequest:request];
    if ((![sourceViewController isKindOfClass:[UIViewController class]])||(![targetViewController isKindOfClass:[UIViewController class]])) {
        *error = [NSError WLRTransitionError];
        return NO;
    }
    if (targetViewController != nil) {
        targetViewController.wlr_request = request;
    }
    BOOL isPreferModal = [self preferModalPresentationWithRequest:request];
    return [self transitionWithWithRequest:request sourceViewController:sourceViewController targetViewController:targetViewController isPreferModal:isPreferModal error:error];
}
```
æ³¨æ„*targetViewController.wlr_request = request*è¿™ä¸€å¥ï¼Œåœ¨è·å–ç›®æ ‡æ§åˆ¶å™¨ä»¥åï¼Œæˆ‘ä»¬ä¼šå°†requestå¯¹è±¡èµ‹å€¼ç»™ç›®æ ‡æ§åˆ¶å™¨ï¼Œè¿™æ˜¯ä¸€ç§æ­£å‘èµ‹å€¼çš„åšæ³•ï¼Œä¸ºäº†é™ä½æ¥å…¥æˆæœ¬ï¼Œåˆ›å»ºä¸€ä¸ªUIViewControllerçš„æ‰©å±•ï¼Œæ·»åŠ wlr_requestè¿™ä¹ˆä¸€ä¸ªå±æ€§ï¼Œè¿™ä¹ˆåšä¹Ÿæ˜¯ä¸å¾—å·²ä¸ºä¹‹ï¼Œå› ä¸ºUIKitåº“ä¸­ViewControllerå¹¶æ²¡æœ‰ä¸Šä¸‹æ–‡æœºåˆ¶ï¼Œä¹Ÿå°±ä¸èƒ½é€šè¿‡æ— å…¥ä¾µçš„å½¢å¼è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚
åœ¨æ­¤æˆ‘ä»¬å‡†å¤‡å¥½è½¬åœºæ‰€éœ€è¦çš„ä¸€åˆ‡ï¼ŒåŒ…æ‹¬æ˜¯å¦æ¨¡æ€è·³è½¬ï¼Œç›®æ ‡æ§åˆ¶å™¨ï¼Œæºæ§åˆ¶å™¨ï¼Œrequestç­‰ç­‰ï¼Œç´§æ¥ç€å°±å¼€å§‹è¿›è¡Œè½¬åœºï¼š
```
-(BOOL)transitionWithWithRequest:(WLRRouteRequest *)request sourceViewController:(UIViewController *)sourceViewController targetViewController:(UIViewController *)targetViewController isPreferModal:(BOOL)isPreferModal error:(NSError *__autoreleasing *)error;{
	if (isPreferModal||![sourceViewController isKindOfClass:[UINavigationController class]]) {
        [sourceViewController presentViewController:targetViewController animated:YES completion:nil];
    }
    else if ([sourceViewController isKindOfClass:[UINavigationController class]]){
        UINavigationController * nav = (UINavigationController *)sourceViewController;
        [nav pushViewController:targetViewController animated:YES];
    }
    return YES;
}
```
è¿™é‡Œç€é‡è¯´ä¸€ä¸‹handlerçš„targetViewControllerWithRequestå’ŒsourceViewControlleræ–¹æ³•ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œæˆ‘è¦ä¸ºæ¯ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨é…ç½®ä¸€å­ç±»å¯¹è±¡ï¼Œåœ¨targetViewControllerWithRequesté‡Œé¢å†™ä¸Šè·å–ç›®æ ‡æ§åˆ¶å™¨çš„æ–¹æ³•ï¼Œä¼šé€ æˆç»§æ‰¿å¾ˆå¤šå¾ˆå¤šhandlerï¼Œå®é™…ä¸Šä½ å¯ä»¥å‘æŒ¥ä¸€ä¸‹æƒ³è±¡åŠ›ï¼Œåœ¨targetViewControllerWithRequestæ–¹æ³•é‡Œï¼Œä½ å·²ç»èƒ½æ‹¿åˆ°requestï¼Œè€Œrequesté‡Œé¢æœ‰è·¯ç”±è¡¨è¾¾å¼ï¼Œå®é™…ä¸Šä¸€ä¸ªè·¯ç”±è¡¨è¾¾å¼åº”è¯¥å¯¹åº”ä¸€ä¸ªæˆ–è€…å¤šä¸ªè§†å›¾æ§åˆ¶å™¨ï¼Œä½ å®Œå…¨å¯ä»¥åšä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨targetViewControllerWithRequestæ–¹æ³•é‡Œé€šè¿‡è·¯ç”±è¡¨è¾¾å¼æ¥è·å–ç›®æ ‡è§†å›¾æ§åˆ¶å™¨çš„åˆå§‹åŒ–ä¿¡æ¯ï¼Œç›®æ ‡æ§åˆ¶å™¨çš„åˆå§‹åŒ–æ— éåˆ†ä¸ºç›´æ¥ä»£ç åˆå§‹åŒ–ï¼Œè¦ä¹ˆæ˜¯storyboardåˆå§‹åŒ–ï¼Œè¦ä¹ˆæ˜¯xibsåˆå§‹åŒ–ï¼Œä½†æ˜¯è¿™ä¸ªé…ç½®æ–‡ä»¶å¦‚ä½•è®¾è®¡å’Œä½¿ç”¨ï¼Œä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒç•´ï¼Œéœ€è¦ä½ å¼€åŠ¨è„‘ç­‹å»è§£å†³ã€‚
åŒæ ·preferModalPresentationWithRequestä¹Ÿå¯ä»¥æ ¹æ®é…ç½®æ¥å¤„ç†æ˜¯å¦è¦è¿›è¡Œæ¨¡æ€è·³è½¬çš„é—®é¢˜ã€‚transitionWithRequestæ–¹æ³•é‡Œé¢æ ¹æ®sourceæ¥è¿›è¡Œå¯¼èˆªpushæˆ–è€…æ˜¯æ¨¡æ€è·³è½¬ï¼Œä½ å¤§å¯ä»¥ç»§æ‰¿ä¸€ä¸‹ï¼Œç„¶åé‡å†™è½¬åœºè¿‡ç¨‹ã€‚
Handlerç±»é‡Œé¢çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ä¸æ˜¯å¾ˆåƒUIViewControllerContextTransitioningè½¬åœºä¸Šä¸‹æ–‡çš„åè®®çš„è®¾å®šï¼Ÿ`- (nullable __kindof UIViewController *)viewControllerForKey:(UITransitionContextViewControllerKey)key;`æ–¹æ³•ä½¿ä¸Šä¸‹æ–‡æä¾›ç›®æ ‡æ§åˆ¶å™¨å’Œæºæ§åˆ¶å™¨ï¼Œå…¶å®åœ¨handlerä¸­ä½ å®Œå…¨å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå­ç±»ï¼Œåœ¨transitionWithRequestæ–¹æ³•é‡Œï¼Œè®¾ç½®éµå®ˆUIViewControllerTransitioningDelegateçš„ä»£ç†ï¼Œç„¶ååœ¨æ­¤æä¾›éµå®ˆ UIViewControllerAnimatedTransitioningçš„åŠ¨ç”»æ§åˆ¶å™¨ï¼Œç„¶åè‡ªå®šä¹‰è½¬åœºä¸Šä¸‹æ–‡ï¼Œå®ç°è‡ªå®šä¹‰UIè½¬åœºï¼Œè€Œå¯¹åº”çš„åŒ¹é…é€»è¾‘æ˜¯ä¸æ­¤æ— å…³çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è·¯ç”±æ›¾æ§åˆ¶å…¨å±€çš„é¡µé¢è½¬åœºæ•ˆæœã€‚å¯¹è‡ªå®šä¹‰è½¬åœºä¸å¤ªç†Ÿæ‚‰çš„åŒå­¦è¯·ç§»æ­¥æˆ‘ä¹‹å‰çš„æ–‡ç« :
[ContainerViewControllerçš„ViewController è½¬åœº](http://www.jianshu.com/p/85447e28f91d)
#### WLRRouteMatcher
```
#import <Foundation/Foundation.h>
@class WLRRouteRequest;
@interface WLRRouteMatcher : NSObject
//ä¼ å…¥URLåŒ¹é…çš„è¡¨è¾¾å¼ï¼Œè·å–ä¸€ä¸ªmatcherå®ä¾‹
+(instancetype)matcherWithRouteExpression:(NSString *)expression;
//ä¼ å…¥URLï¼Œå¦‚æœèƒ½åŒ¹é…ä¸Šï¼Œåˆ™ç”ŸæˆWLRRouteRequestå¯¹è±¡ï¼ŒåŒæ—¶å°†å„ç§å‚æ•°è§£æå¥½äº¤ç”±WLRRouteRequestæºå¸¦
-(WLRRouteRequest *)createRequestWithURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError *, id responseObject))targetCallBack;
@end
```
Matcherå¯¹è±¡éœ€è¦ä¼ å…¥ä¸€ä¸ªURLå¯¹è±¡æ¥åˆ¤æ–­æ˜¯å¦åŒ¹é…ï¼Œç”Ÿæˆrequestå¯¹è±¡ï¼Œè¯´åˆ°åŒ¹é…å°±ä¸€å®šä¸ä¼šå‚»å‚»çš„ç”¨å­—ç¬¦ä¸²ç›¸ç­‰ï¼Œè‚¯å®šæ˜¯è¦å€ŸåŠ©æ­£åˆ™è¡¨è¾¾å¼æ¥åˆ¤æ–­æ˜¯å¦åŒ¹é…å’Œå°†åˆ†ç»„çš„å†…å®¹ä»å­—ç¬¦ä¸²ä¸­å–å‡ºï¼Œæˆ‘ä»¬åˆå§‹åŒ–Macterå¯¹è±¡çš„æ—¶å€™è¦åˆ†é…ä¸€ä¸ªUrlè¡¨è¾¾å¼ç»™å®ƒï¼Œæ ¼å¼å‰é¢æåˆ°è¿‡ï¼ŒUrlè¯¸å¦‚http://abc.com/:name([a-zA-Z0-9-_]+) çš„æ ¼å¼å¹¶ä¸æ˜¯çœŸæ­£çš„æ ‡å‡†æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚æœè¦æŠŠnameå–å‡ºï¼Œåˆ™å¿…é¡»å°†å…¶è£…æ¢ä¸ºæ ‡å‡†çš„æ­£åˆ™è¡¨è¾¾å¼åƒï¼š^http://abc.com/([a-zA-Z0-9-_]+)$ è¿™æ ·ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œè½¬æ¢å’Œæå–:åé¢çš„keyå€¼ï¼Œåœ¨Fundactionåº“ä¸­ï¼ŒNSRegularExpressionæ˜¯ç”¨æ¥å¤„ç†æ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œä¸ºäº†ä½¿é€»è¾‘æ›´åŠ æ¸…æ™°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™æ ·çš„é€»è¾‘é€šè¿‡ç»§æ‰¿NSRegularExpressionå°è£…åˆ°ä¸€ä¸ªå«WLRRegularExpressionçš„ç±»ä¸­ï¼Œè¿™ä¸ªç±»æä¾›åŒ¹é…å’Œè½¬æ¢æ ‡å‡†æ­£åˆ™è¡¨è¾¾å¼çš„åŠŸèƒ½å¦‚ä¸‹ï¼š

![WLRRegularExpression](http://upload-images.jianshu.io/upload_images/24274-cfeaea797a6206a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
åŒ¹é…çš„ç»“æœæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªWLRMatchResultæ¥è¡¨ç¤ºã€‚ä¼ å…¥è·¯ç”±urlçš„åŒ¹é…è¡¨è¾¾å¼ç©¿å®è¯WLRRegularExpressionå®ä¾‹ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±è½¬æ¢ä¸ºæ ‡å‡†çš„æ­£åˆ™è¡¨è¾¾å¼å’Œå°†ï¼šåé¢çš„keyçš„åå­—ä¿å­˜åˆ°routerParamNamesArrå½“ä¸­ï¼ŒmatchResultForStringæ¥å£å¯æ¥å—ä¸€ä¸ªUrlä»è€Œç”ŸæˆåŒ¹é…ç»“æœçš„å¯¹è±¡ï¼ŒåŒ¹é…ç»“æœçš„å¯¹è±¡é‡Œå­˜å‚¨ç€è·¯å¾„å‚æ•°ä¿¡æ¯å’Œæ˜¯å¦åŒ¹é…çš„ç»“æœã€‚

```
#import <Foundation/Foundation.h>
@class WLRMatchResult;
@interface WLRRegularExpression : NSRegularExpression
//ä¼ å…¥ä¸€ä¸ªURLè¿”å›ä¸€ä¸ªåŒ¹é…ç»“æœ
-(WLRMatchResult *)matchResultForString:(NSString *)string;
//æ ¹æ®ä¸€ä¸ªURLçš„è¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªWLRRegularExpressionå®ä¾‹
+(WLRRegularExpression *)expressionWithPattern:(NSString *)pattern;
@end
```
WLRRegularExpressionç»§æ‰¿NSRegularExpression

```
-(instancetype)initWithPattern:(NSString *)pattern options:(NSRegularExpressionOptions)options error:(NSError * _Nullable __autoreleasing *)error{
//åˆå§‹åŒ–æ–¹æ³•ä¸­å°†URLåŒ¹é…çš„è¡¨è¾¾å¼patternè½¬æ¢ä¸ºçœŸæ­£çš„æ­£åˆ™è¡¨è¾¾å¼
    NSString *transformedPattern = [WLRRegularExpression transfromFromPattern:pattern];
//ç”¨è½¬åŒ–åçš„ç»“æœåˆå§‹åŒ–çˆ¶ç±»
    if (self = [super initWithPattern:transformedPattern options:options error:error]) {
//åŒæ—¶å°†éœ€è¦æå–çš„å­ä¸²çš„å€¼çš„Keyä¿å­˜åˆ°æ•°ç»„ä¸­
        self.routerParamNamesArr = [[self class] routeParamNamesFromPattern:pattern];
    }
    return self;
}
//è½¬æ¢ä¸ºæ­£åˆ™è¡¨è¾¾å¼
+(NSString*)transfromFromPattern:(NSString *)pattern{
//å°†patternæ‹·è´
    NSString * transfromedPattern = [NSString stringWithString:pattern];
//åˆ©ç”¨:[a-zA-Z0-9-_][^/]+è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå°†URLåŒ¹é…çš„è¡¨è¾¾å¼çš„å­ä¸²keyæå–å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯åƒ /login/:phone([0-9]+)/:name[a-zA-Z-_]è¿™æ ·çš„patternï¼Œéœ€è¦å°†:phone([0-9]+)å’Œ:name[a-zA-Z-_]æå–å‡ºæ¥
    NSArray * paramPatternStrings = [self paramPatternStringsFromPattern:pattern];
    NSError * err;
//å†æ ¹æ®:[a-zA-Z0-9-_]+è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå°†å¸¦æœ‰æå–å­ä¸²çš„keyå…¨éƒ¨å»é™¤ï¼Œæ¯”å¦‚å°†:phone([0-9]+)å»é™¤:phoneæ”¹æˆ([0-9]+)
    NSRegularExpression * paramNamePatternEx = [NSRegularExpression regularExpressionWithPattern:WLRRouteParamNamePattern options:NSRegularExpressionCaseInsensitive error:&err];
    for (NSString * paramPatternString in paramPatternStrings) {
        NSString * replaceParamPatternString = [paramPatternString copy];
        NSTextCheckingResult * foundParamNamePatternResult =[paramNamePatternEx matchesInString:paramPatternString options:NSMatchingReportProgress range:NSMakeRange(0, paramPatternString.length)].firstObject;
        if (foundParamNamePatternResult) {
            NSString *paramNamePatternString =[paramPatternString substringWithRange: foundParamNamePatternResult.range];
            replaceParamPatternString = [replaceParamPatternString stringByReplacingOccurrencesOfString:paramNamePatternString withString:@""];
        }
        if (replaceParamPatternString.length == 0) {
            replaceParamPatternString = WLPRouteParamMatchPattern;
        }
        transfromedPattern = [transfromedPattern stringByReplacingOccurrencesOfString:paramPatternString withString:replaceParamPatternString];
    }
    if (transfromedPattern.length && !([transfromedPattern characterAtIndex:0] == '/')) {
        transfromedPattern = [@"^" stringByAppendingString:transfromedPattern];
    }
//æœ€åç»“å°¾è¦ç”¨$ç¬¦å·
    transfromedPattern = [transfromedPattern stringByAppendingString:@"$"];
//æœ€åä¼šå°†/login/:phone([0-9]+)è½¬æ¢ä¸ºlogin/([0-9]+)$
    return transfromedPattern;
}
```
åœ¨Matcherå¯¹è±¡åŒ¹é…ä¸€ä¸ªURLçš„æ—¶å€™

```
-(WLRMatchResult *)matchResultForString:(NSString *)string{
//é¦–å…ˆé€šè¿‡è‡ªèº«æ–¹æ³•å°†URLè¿›è¡ŒåŒ¹é…å¾—å‡ºNSTextCheckingResultç»“æœçš„æ•°ç»„
    NSArray * array = [self matchesInString:string options:0 range:NSMakeRange(0, string.length)];
    WLRMatchResult * result = [[WLRMatchResult alloc]init];
    if (array.count == 0) {
        return result;
    }
    result.match = YES;
    NSMutableDictionary * paramDict = [NSMutableDictionary dictionary];
//éå†NSTextCheckingResultç»“æœ
    for (NSTextCheckingResult * paramResult in array) {
//å†ä¾¿åˆ©æ ¹æ®åˆå§‹åŒ–çš„æ—¶å€™æå–çš„å­ä¸²çš„Keyçš„æ•°ç»„
        for (int i = 1; i<paramResult.numberOfRanges&&i <= self.routerParamNamesArr.count;i++ ) {
            NSString * paramName = self.routerParamNamesArr[i-1];
//å°†å€¼å–å‡ºï¼Œç„¶åå°†keyå’Œvalueæ”¾å…¥åˆ°paramDict
            NSString * paramValue = [string substringWithRange:[paramResult rangeAtIndex:i]];
            [paramDict setObject:paramValue forKey:paramName];
        }
    }
//æœ€åèµ‹å€¼ç»™WLRMatchResultå¯¹è±¡
    result.paramProperties = paramDict;
    return result;
}
```
Okï¼Œæœ‰äº†WLRRegularExpressionå’ŒWLRMatchResultä»¥åï¼ŒWLRRouteMatcherå¯ä»¥æ¥ä¸‹æ¥è¡¥å……ï¼Œå±æ€§æœ‰å¦‚ä¸‹ï¼š

```
//scheme
@property(nonatomic,copy) NSString * scheme;
//WLRRegularExpressionçš„å®ä¾‹ 
@property(nonatomic,strong)WLRRegularExpression * regexMatcher;
//åŒ¹é…çš„è¡¨è¾¾å¼
@property(nonatomic,copy)NSString * routeExpressionPattern;
```
åˆå§‹åŒ–æ–¹æ³•å°†å½¢æˆWLRRegularExpressionå¯¹è±¡ï¼š

```
-(instancetype)initWithRouteExpression:(NSString *)routeExpression{
    if (![routeExpression length]) {
        return nil;
    }
    if (self = [super init]) {
//å°†schemeä¸pathéƒ¨åˆ†åˆ†åˆ«å–å‡º
        NSArray * parts = [routeExpression componentsSeparatedByString:@â€œ://â€œ];
        _scheme = parts.count>1?[parts firstObject]:nil;
        _routeExpressionPattern =[parts lastObject];
//å°†pathéƒ¨åˆ†å½“åšURLåŒ¹é…è¡¨è¾¾å¼ç”ŸæˆWLRRegularExpressionå®ä¾‹
        _regexMatcher = [WLRRegularExpression expressionWithPattern:_routeExpressionPattern];
    }
    return self;
}
```
åŒ¹é…æ–¹æ³•å°±æ˜¯é€šè¿‡WLRRegularExpressionå¯¹è±¡æ¥ç”Ÿæˆresultæ¥æ£€æµ‹æ˜¯å¦èƒ½å¤ŸåŒ¹é…ï¼Œå¦‚æœèƒ½åŒ¹é…åˆ™ç”ŸæˆWLRRouteRequestå¯¹è±¡ï¼š

```
-(WLRRouteRequest *)createRequestWithURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void (^)(NSError *, id))targetCallBack{
    NSString * urlString = [NSString stringWithFormat:@â€œ%@%@â€œ,URL.host,URL.path];
    if (self.scheme.length && ![self.scheme isEqualToString:URL.scheme]) {
        return nil;
    }
//è°ƒç”¨self.regexMatcherå°†URLä¼ å…¥ï¼Œè·å–WLRMatchResultç»“æœï¼Œçœ‹æ˜¯å¦åŒ¹é…
    WLRMatchResult * result = [self.regexMatcher matchResultForString:urlString];
    if (!result.isMatch) {
        return nil;
    }
//å¦‚æœåŒ¹é…ï¼Œåˆ™å°†result.paramPropertiesè·¯å¾„å‚æ•°ä¼ å…¥ï¼Œåˆå§‹åŒ–ä¸€ä¸ªWLRRouteRequestå®ä¾‹
    WLRRouteRequest * request = [[WLRRouteRequest alloc]initWithURL:URL routeExpression:self.routeExpressionPattern routeParameters:result.paramProperties primitiveParameters:primitiveParameters targetCallBack:targetCallBack];
    return request;
}
```
å‘Šä¸€æ®µè½ï¼Œè¿™éƒ¨åˆ†å…¶å®ç®—æ˜¯è·¯ç”±ç»„ä»¶ä¸­æ¯”è¾ƒæ ¸å¿ƒçš„é€»è¾‘ï¼Œä¸ºä»€ä¹ˆè¦æ‹†æˆä¸‰ä¸ªç±»ï¼Œå¤§å®¶æ€è€ƒä¸€ä¸‹åˆ†å‰²é€»è¾‘çš„æ€æƒ³ï¼ŒèŒè´£å•ä¸€ä»¥åï¼Œä½ æ‰ä¼šèšç„¦ç›®çš„æœ¬èº«ã€‚
### WLRRouter
å®Œæˆäº†ä»¥ä¸Šå‡ ä¸ªç±»çš„å®ç°ï¼ŒWLRRouterå°±æ¯”è¾ƒå®¹æ˜“äº†ã€‚

```
@class WLRRouteRequest;
@class WLRRouteHandler;
@interface WLRRouter : NSObject
//æ³¨å†Œblockå›è°ƒçš„URLåŒ¹é…è¡¨è¾¾å¼ï¼Œå¯ç”¨ä½œå†…éƒ¨è°ƒç”¨
-(void)registerBlock:(WLRRouteRequest *(^)(WLRRouteRequest * request))routeHandlerBlock forRoute:(NSString *)route;
//æ³¨å†Œä¸€ä¸ªWLRRouteHandlerå¯¹åº”çš„URLåŒ¹é…è¡¨è¾¾å¼route
-(void)registerHandler:(WLRRouteHandler *)handler forRoute:(NSString *)route;
//åˆ¤æ–­urlæ˜¯å¦å¯ä»¥è¢«handle
-(BOOL)canHandleWithURL:(NSURL *)url;
-(void)setObject:(id)obj forKeyedSubscript:(NSString *)key;
-(id)objectForKeyedSubscript:(NSString *)key;
//è°ƒç”¨handleURLæ–¹æ³•ï¼Œä¼ å…¥URLã€åŸç”Ÿå‚æ•°å’ŒtargetCallBackå’Œå®ŒæˆåŒ¹é…çš„completionBlock
-(BOOL)handleURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError *, id responseObject))targetCallBack withCompletionBlock:(void(^)(BOOL handled, NSError *error))completionBlock;
```

åœ¨å®ç°éƒ¨åˆ†ï¼Œæœ‰ä¸‰ä¸ªå±æ€§ï¼Œè¿™ä¸‰ä¸ªå±æ€§ç”¨æ¥è®¾ç½®matcherã€handlerã€blockçš„å¯¹åº”å…³ç³»ï¼Œkeyéƒ½ä¸ºè·¯ç”±è¡¨è¾¾å¼ï¼š

```
//æ¯ä¸€ä¸ªURLçš„åŒ¹é…è¡¨è¾¾å¼å¯¹åº”ä¸€ä¸ªmatcherå®ä¾‹ï¼Œæ”¾åœ¨å­—å…¸ä¸­
@property(nonatomic,strong)NSMutableDictionary * routeMatchers;
//æ¯ä¸€ä¸ªURLåŒ¹é…è¡¨è¾¾å¼routeå¯¹åº”ä¸€ä¸ªWLRRouteHandlerå®ä¾‹
@property(nonatomic,strong)NSMutableDictionary * routeHandles;
//æ¯ä¸€ä¸ªURLåŒ¹é…è¡¨è¾¾å¼routeå¯¹åº”ä¸€ä¸ªå›è°ƒçš„block
@property(nonatomic,strong)NSMutableDictionary * routeblocks;
```

åœ¨Routeræ³¨å†ŒHandlerå’Œå›è°ƒçš„blockçš„æ—¶å€™:

```
-(void)registerBlock:(WLRRouteRequest *(^)(WLRRouteRequest *))routeHandlerBlock forRoute:(NSString *)route{
    if (routeHandlerBlock && [route length]) {
//é¦–å…ˆæ·»åŠ ä¸€ä¸ªWLRRouteMatcherå®ä¾‹
        [self.routeMatchers setObject:[WLRRouteMatcher matcherWithRouteExpression:route] forKey:route];
//åˆ é™¤routeå¯¹åº”çš„handlerå¯¹è±¡
        [self.routeHandles removeObjectForKey:route];
//å°†routeHandlerBlockå’Œrouteå­˜å…¥å¯¹åº”å…³ç³»çš„å­—å…¸ä¸­
        self.routeblocks[route] = routeHandlerBlock;
    }
}
-(void)registerHandler:(WLRRouteHandler *)handler forRoute:(NSString *)route{
    if (handler && [route length]) {
//é¦–å…ˆç”Ÿæˆrouteå¯¹åº”çš„WLRRouteMatcherå®ä¾‹
        [self.routeMatchers setObject:[WLRRouteMatcher matcherWithRouteExpression:route] forKey:route];
//åˆ é™¤routeå¯¹åº”çš„blockå›è°ƒ
        [self.routeblocks removeObjectForKey:route];
//è®¾ç½®routeå¯¹åº”çš„handler
        self.routeHandles[route] = handler;
    }
}

```
æ¥ä¸‹æ¥å®Œå–„handleæ–¹æ³•ï¼Œè®¾ç½®completionHandlerå¯ä»¥ç›‘å¬Routerçš„æ¯ä¸€æ¬¡handleåŠ¨ä½œ:

```
-(BOOL)handleURL:(NSURL *)URL primitiveParameters:(NSDictionary *)primitiveParameters targetCallBack:(void(^)(NSError *error, id responseObject))targetCallBack withCompletionBlock:(void(^)(BOOL handled, NSError *error))completionBlock{
    if (!URL) {
        return NO;
    }
    NSError * error;
    WLRRouteRequest * request;
    __block BOOL isHandled = NO;
//éå†routeMatchersä¸­çš„WLRRouteMatcherå¯¹è±¡ï¼Œå°†URLä¼ å…¥å¯¹è±¡ï¼Œçœ‹æ˜¯å¦èƒ½å¾—åˆ°WLRRouteRequestå¯¹è±¡
    for (NSString * route in self.routeMatchers.allKeys) {
        WLRRouteMatcher * matcher = [self.routeMatchers objectForKey:route];
        WLRRouteRequest * request = [matcher createRequestWithURL:URL primitiveParameters:primitiveParameters targetCallBack:targetCallBack];
        if (request) {
//å¦‚æœå¾—åˆ°WLRRouteRequestå¯¹è±¡ï¼Œè¯´æ˜åŒ¹é…æˆåŠŸï¼Œåˆ™è¿›è¡Œhandlerçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°è°ƒç”¨æˆ–æ˜¯è¿™blockå›è°ƒ
            isHandled = [self handleRouteExpression:route withRequest:request error:&error];
            break;
        }
    }
    if (!request) {
        error = [NSError WLRNotFoundError];
    }
//åœ¨è°ƒç”¨å®Œæ¯•blockæˆ–è€…æ˜¯handlerçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä»¥åï¼Œå›è°ƒå®Œæˆçš„completionHandler
    [self completeRouteWithSuccess:isHandled error:error completionHandler:completionBlock];
    return isHandled;
}
//æ ¹æ®requestè¿›è¡Œhandlerçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°è°ƒç”¨æˆ–è€…æ˜¯blockå›è°ƒ
-(BOOL)handleRouteExpression:(NSString *)routeExpression withRequest:(WLRRouteRequest *)request error:(NSError *__autoreleasing *)error {
    id handler = self[routeExpression];
//self.routeHandleså’Œself.routeblocksæ‹¿åˆ°routeå¯¹åº”çš„å›è°ƒblockæˆ–è€…æ˜¯handlerå®ä¾‹
    if ([handler isKindOfClass:NSClassFromString(@"NSBlock")]) {
        WLRRouteRequest *(^blcok)(WLRRouteRequest *) = handler;
//è°ƒç”¨å›è°ƒçš„block
        WLRRouteRequest * backRequest = blcok(request);
//åˆ¤æ–­blocké‡Œé¢æ˜¯å¦æ¶ˆè´¹äº†æ­¤requestï¼Œå¦‚æœæ²¡æœ‰è€Œç›®æ ‡è®¾ç½®äº†ç›®æ ‡å›è°ƒtargetCallBackï¼Œé‚£ä¹ˆåœ¨æ­¤è¿›è¡Œé»˜è®¤å›è°ƒ
        if (backRequest.isConsumed==NO) {
            if (backRequest.targetCallBack) {
                dispatch_async(dispatch_get_main_queue(), ^{
                    backRequest.targetCallBack(nil,nil);
                });
            }
        }
        return YES;
    }
    else if ([handler isKindOfClass:[WLRRouteHandler class]]){
//æ‹¿åˆ°urlå¯¹åº”çš„handlerå¯¹è±¡åï¼Œå…ˆè°ƒç”¨handlerçš„shouldHandleWithRequestæ–¹æ³•ï¼Œå¦‚æœè¿”å›YESï¼Œåˆ™è°ƒç”¨è¿›è¡Œè½¬åœºçš„transitionWithRequestæ–¹æ³•
        WLRRouteHandler * rHandler = (WLRRouteHandler *)handler;
        if (![rHandler shouldHandleWithRequest:request]) {
            return NO;
        }
       return [rHandler transitionWithRequest:request error:error];
    }
    return YES;
}
```

ä»¥ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒRouterå°†åŒ¹é…çš„é€»è¾‘å•ç‹¬å°è£…åˆ°WLRRouteMatcherå¯¹è±¡ä¸­ï¼Œå°†åŒ¹é…åçš„ç»“æœç”ŸæˆWLRRouteRequestå®ä¾‹ä»¥æºå¸¦è¶³å¤Ÿå®Œæ•´çš„æ•°æ®ï¼ŒåŒæ—¶å°†çœŸæ­£å¤„ç†è§†å›¾æ§åˆ¶å™¨çš„è½¬åœºæˆ–è€…æ˜¯ç»„ä»¶çš„åŠ è½½æˆ–è€…æ˜¯æœªæ¥å¯èƒ½æ‹“å±•çš„handlerä¸šåŠ¡å°è£…åˆ°WLRRouteHandlerå®ä¾‹ä¸­ï¼ŒåŒ¹é…é€»è¾‘å¯¹åº”çš„å¤„ç†é€»è¾‘å¹²å‡€åˆ†ç¦»ï¼ŒMatcherå¯¹è±¡å°†åŒ¹é…é€»è¾‘å•ç‹¬å°è£…ï¼Œå¦‚æœæœ‰ä¸€å¤©éœ€è¦å¢åŠ å¤šç§URLçš„åŒ¹é…é€»è¾‘ï¼Œåˆ™å¯ä»¥æ›´æ¢Matcheræˆ–è€…æ·»åŠ Matcherå°±å¯ä»¥ï¼Œå¤„ç†é€»è¾‘å¯ä»¥é€šè¿‡ç»§æ‰¿æ‰©å±•æˆ–è€…å†²æ´—WLRRouteHandlerçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ¥æ›´å¥½çš„å¤„ç†å›è°ƒä¸šåŠ¡ã€‚å¦‚æœWLRRouteHandlerä¸èƒ½æä¾›è¶³å¤Ÿå¤šçš„æ‰©å±•æ€§ï¼Œåˆ™å¯ä»¥ä½¿ç”¨blockå›è°ƒæœ€å¤§é™åº¦çš„è¿›è¡Œæ‰©å±•ã€‚
ä»¥ä¸Šï¼Œå°±æ˜¯è·¯ç”±éƒ¨åˆ†çš„æ•´ä½“å®ç°ã€‚
> Tips:  
> 		åœ¨å…·ä½“çš„å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œä¸è¦è¢«æ€»ä½“è®¾è®¡ç»™å¥—æ­»ï¼Œå‰é¢è®¾è®¡äº†å‡ ä¸ªç±»ï¼Œè®¾è®¡äº†å‡ ä¸ªå±‚æ¬¡ä»¥åï¼Œå°±ç”»åœ°ä¸ºç‰¢ï¼Œåœ¨å®ç°å…·ä½“ç»†èŠ‚çš„æ—¶å€™ä»å¯ä»¥ç»§ç»­è¿›è¡Œå±€éƒ¨è®¾è®¡ï¼Œåˆ†å‰²é€»è¾‘ï¼Œæ§åˆ¶ä»£ç å¤æ‚åº¦ï¼Œä¸€æ–¹é¢ä½ è¦æ³¨é‡åœ¨å±€éƒ¨è¿›è¡Œè¿›ä¸€æ­¥è®¾è®¡å’Œåˆ†å‰²çš„æ—¶å€™å¸¦æ¥çš„ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œå¯è¯»æ€§ï¼Ÿå¯ç»´æŠ¤æ€§ï¼Ÿè¿˜æ˜¯å¸®åŠ©ä½ èƒ½å¤Ÿè¿›è¡Œæ€è€ƒï¼Ÿæœ‰æ—¶å€™ï¼Œæ³¨é‡Šå¯èƒ½æ›´åŠ èƒ½ç»™ä½ çš„é€»è¾‘å¸¦æ¥æ¸…æ™°çš„è¡¨è¿°ï¼Œæ¯•ç«Ÿå‡ åƒè¡Œçš„ä»£ç å¾ˆæ­£å¸¸ï¼Œå¦‚æœæ²¡æœ‰ç»éªŒï¼Œå¯èƒ½é€»è¾‘é‡ç‚¹è®°å¾—ä¸å¤ªæ¸…æ¥šï¼Œé‚£å°±éœ€è¦åŠ¨åŠ¨ç¬”å¤´å¥½å¥½è®°å½•ä¸€ä¸‹ï¼Œå†è¿›ä¸€æ­¥å®ç°ï¼Œå°†å¤æ‚é€»è¾‘è¿›è¡Œé€‚å½“åˆ†å‰²ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„ç­–ç•¥  

### æœ€ç»ˆçš„è·¯ç”±æ•´ä½“ç±»å›¾å’Œå¦‚ä½•è®¾è®¡ä»£ç çš„æ€»ç»“ï¼š

![WLRRoute](http://upload-images.jianshu.io/upload_images/24274-669cb74163367bd1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æ•´ä½“çš„è®¾è®¡å°±æ˜¯å¦‚æ­¤ï¼Œæˆ‘ä»¬èµ°äº†ä¸€è¶Ÿä»å‘ç°é—®é¢˜åˆ°æœ€åé€šè¿‡å°è£…ä¸€ä¸ªè·¯ç”±ç»„ä»¶è§£å†³é—®é¢˜çš„è¿‡ç¨‹ï¼Œåœ¨è¿™é‡Œï¼Œå¯¹äºæ–°æ‰‹ç¨‹åºå‘˜æˆ‘æƒ³è®¨è®ºä¸€äº›æœ‰æ„ä¹‰çš„ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯æ‰‹æŠŠæ‰‹å†™å‡ºä¸€ä¸ªè·¯ç”±çš„è¿‡ç¨‹ä¸­ï¼Œæ€è·¯ä»ä½•è€Œæ¥ï¼Ÿä»£ç è®¾è®¡æ€ä¹ˆä»æ— åˆ°æœ‰ï¼Ÿå¯¹äºä¸€ä¸ªé€»è¾‘é—®é¢˜æ€ä¹ˆè½¬æ¢ä¸ºä»£ç å®è·µï¼Ÿæˆä¹‹ä»¥é±¼ä¸å¦‚æˆä¹‹ä»¥æ¸”ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å“ªäº›æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼š
1. å¯¹äºç»å¸¸é‡å¤çš„å·¥ä½œå’Œä½æ•ˆçš„å·¥ä½œæµç¨‹æœ‰æ²¡æœ‰æ•é”çš„å¯Ÿè§‰ï¼Œæ˜¯å¦æœ‰æƒ³è§£å†³çš„æ„¿æœ›ï¼Œæ¯•ç«Ÿèƒ½è§£å†³äº†ä½ èƒ½èŠ‚çœæ›´å¤šæ—¶é—´ï¼Œä½•ä¹è€Œä¸ä¸ºï¼Ÿå¯æœ‰äº›äººå®æ„¿åŠ ç­åšä¸€äº›ç®€å•çš„é‡å¤å·¥ä½œä¹Ÿä¸å¸Œæœ›ç›´é¢æŒ‘æˆ˜åˆ›é€ ä¸€äº›è§£å†³é—®é¢˜çš„æ–°æ–¹å¼
2. åœ¨æ€è€ƒé—®é¢˜çš„è§£å†³æ–¹æ¡ˆçš„æ—¶å€™ï¼Œå¤§è„‘æœ‰æ²¡æœ‰å°†é—®é¢˜æŠ½è±¡ä¸€ä¸‹å»å¯»æ‰¾æœ‰æ²¡æœ‰ç›¸åº”è§£å†³é—®é¢˜çš„æ¨¡å¼ã€æ–¹æ³•è®ºæˆ–è€…æ˜¯æ–¹æ¡ˆï¼Ÿ(æ¯”å¦‚è¯´å‘ç°è·¯ç”±æ–¹æ¡ˆï¼Œå‘ç°ä¸­ä»‹è€…æ¨¡å¼ï¼Œå‘ç°åˆ†å‰²æ€æƒ³å’ŒèŒè´£å•ä¸€ï¼Œå‘ç°è½¯ä»¶å·¥ç¨‹çš„æµç¨‹)
3. å¤©èµ‹å¹¶ä¸æ˜¯æœ€é‡è¦çš„ï¼Œç”šè‡³å¤©èµ‹æ˜¯ä¸€ç§ç»“è®ºè€Œä¸æ˜¯æ¡ä»¶ï¼Œå¤§è„‘ä¸æ“…é•¿åŒæ—¶å¤„ç†å¾ˆå¤šäº‹æƒ…ï¼Œåœ¨ä½ è®¾è®¡æˆ–è€…ç¼–ç çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ ‡å‡†åŒ–æµç¨‹èƒ½æœ€å¤§ç¨‹åº¦çš„æé«˜å¤§è„‘æ€è€ƒçš„æ•ˆç‡ï¼Œæ¯”æ–¹è¯´ï¼Œæ€»ç»“é—®é¢˜å°±æ˜¯æ€»ç»“é—®é¢˜è€Œä¸è¦å˜æ€»ç»“å˜æ€è€ƒè§£å†³æ–¹æ¡ˆï¼Œå¦åˆ™ä¼šç‰‡é¢æˆ–è€…å½±å“é—®é¢˜çš„å®¢è§‚æè¿°ï¼Œæ€»ç»“é—®é¢˜->éœ€æ±‚åˆ†æ->æ€»ä½“è®¾è®¡->å…·ä½“å®ç°ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¤§è„‘æ€è€ƒæµç¨‹ï¼Œå¦‚æœæƒ³ä¸æ¸…æ¥šï¼Œé€šè¿‡æ€ç»´å¯¼å›¾ã€æµç¨‹å›¾ã€UMLå»ºæ¨¡ç­‰ç­‰ï¼Œå»æŠŠå¤§è„‘éœ€è¦åŒæ—¶ç…§é¡¾åˆ°çš„ä¸œè¥¿å‘ˆç°åœ¨çœ¼å‰ï¼Œä½ åªè¦å»å¯¹æ¯”å¯¹ç…§ï¼Œä¸€æ­¥æ­¥æ¥å°±å¯ä»¥äº†ï¼Œå¹¶ä¸æ˜¯æœ‰äººç‰¹åˆ«æœ‰å¤©èµ‹ï¼Œè€Œæ˜¯æœ‰äººæ¯”ä½ æœ‰æ–¹æ³•
4. å‘æ•£å¾ˆé‡è¦ï¼Œæ¯å½“ä½ ä»å‡ºç°é—®é¢˜åˆ°è§£å†³é—®é¢˜ä»¥åï¼Œä½ å¯ä»¥å®‰å¿ƒçš„å¤©é©¬è¡Œç©ºçš„å¤´è„‘é£æš´ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä½ å¯èƒ½å¯¹è§£å†³é—®é¢˜çš„æ–¹å¼è¿›è¡Œé‡æ–°å®¡è§†å’Œå›é¡¾ï¼Œå‘ç°ä¸è¶³ï¼Œç”šè‡³å¯ä»¥å¯¹å…¶æ‰©å±•ä½¿å…¶èƒ½è§£å†³æ›´å¤šé—®é¢˜ï¼Œå°±æ¯”å¦‚ä½ ä¼šè€ƒè™‘è·¯ç”±çš„æ•ˆç‡ã€å®‰å…¨ï¼Œä»è€Œè¯ç”Ÿä¸­é—´ä»¶ã€å¼‚æ­¥äº‹ä»¶çš„æƒ³æ³•ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œä½†å´å¾ˆç®€å•
5. è‡ªæˆ‘å¼•å¯¼èƒ½åŠ›ï¼Œçœ‹äº†æ–‡ç« ä¸€æ­¥æ­¥åšäº†å‡ºæ¥ï¼Œå…¶å®å°±è·Ÿåšèœä¸€æ ·ï¼Œä½ å­¦ä¼šäº†ä¸€é“èœè¯¥æ€ä¹ˆåšï¼Œä½†ä¸ºä»€ä¹ˆåˆ«äººèƒ½åšï¼Œæˆ–è€…è¯´åˆ«äººä»æ— åˆ°æœ‰çš„è¿‡ç¨‹ç»å†äº†ä»€ä¹ˆï¼Œä½ ä¸ºä»€ä¹ˆæ²¡æƒ³åˆ°ï¼Œè¿™ç§æƒ³æ³•ä¼šæ¿€åŠ±ä½ è‡ªæˆ‘å¼•å¯¼ï¼Œä»è€Œæå‡è‡ªå·±ï¼Œè¿›ä¸€æ­¥æ”¹å˜è‡ªå·±ï¼Œå¦‚æœä½ ä»æ¥æ²¡æœ‰å¯¹ä»–äººä¸ºä»€ä¹ˆèƒ½åšåˆ°æ„Ÿåˆ°å¥½å¥‡ï¼Œé‚£å°±è¯´æ˜ä½ çš„è‡ªæˆ‘æ„è¯†å’Œè‡ªæˆ‘å¼•å¯¼åŠ›ä¸å¤Ÿå¼ºï¼Œéœ€è¦åœä¸‹æ¯å¤©å†™ä»£ç çš„æ‰‹ï¼Œè®¤çœŸæ€è€ƒä¸€ä¸‹äººç”Ÿäº†

### è·¯ç”±çš„å®‰å…¨
æœ‰ä¸¤ä¸ªæ–¹é¢å¯ä»¥å»åš
1. WLRRouteHandlerå®ä¾‹ä¸­ï¼Œ `-(BOOL)shouldHandleWithRequest:(WLRRouteRequest *)request`ä¸­å¯ä»¥æ£€æµ‹requestä¸­çš„å‚æ•°ï¼Œæ¯”æ–¹è¯´æ•ˆéªŒsourceæˆ–è€…æ˜¯æ•ˆéªŒä¸šåŠ¡å‚æ•°å®Œæ•´ç­‰
2. WLRRouterå®ä¾‹ä¸­handleURLæ–¹æ³•ï¼Œå°†æŒ‰ç…§ä¸­é—´ä»¶æ³¨å†Œçš„é¡ºåºå›è°ƒä¸­é—´ä»¶ï¼Œè€Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸­é—´ä»¶ä¸­å®ç°é£æ§ä¸šåŠ¡ã€è®¤è¯æœºåˆ¶ã€åŠ å¯†éªŒç­¾ç­‰ç­‰ï¼Œä¸­é—´ä»¶çš„å®ç°å¤§å®¶å¯æŸ¥çœ‹æºç 

### è·¯ç”±çš„æ•ˆç‡
ç›®å‰æˆ‘ä»¬å®ç°çš„è·¯ç”±æ˜¯ä¸€ä¸ªåŒæ­¥é˜»å¡å‹çš„ï¼Œåœ¨å¤„ç†å¹¶å‘çš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæˆ–è€…æ˜¯åœ¨æ³¨å†Œæ¯”è¾ƒå¤šçš„routeè¡¨è¾¾å¼ä»¥åï¼Œéå†å’ŒåŒ¹é…çš„è¿‡ç¨‹ä¼šæŸè€—æ€§èƒ½ï¼Œæ¯”è¾ƒå¥½çš„å®ç°æ–¹å¼æ˜¯ï¼Œå°†Routeä¿®æ”¹æˆå¼‚æ­¥éé˜»å¡å‹çš„ï¼Œä½†æ˜¯APIå…¨éƒ¨è¦æ¢æˆå¼‚æ­¥APIï¼Œèµ·æ­¥æˆ‘ä»¬å…ˆæŠŠåŒæ­¥å‹çš„æå®šï¼Œéšåæˆ‘ä»¬å°†ä¼šå‚ç…§promiseèŒƒå¼æ¥è¿›è¡Œå¼‚æ­¥æ”¹é€ ï¼Œæå‡è·¯ç”±æ•ˆç‡ã€‚

### è·¯ç”±çš„ä½¿ç”¨
åœ¨å¤§éƒ¨åˆ†Appå®è·µMVVMæ¶æ„æˆ–è€…æ›´ä¸ºå¤æ‚çš„VIPERæ¶æ„çš„æ—¶å€™ï¼Œé™¤äº†è¿«åˆ‡éœ€è¦ä¸€ä¸ªæ¯”è¾ƒè§£è€¦çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œå¦‚ä½•æ›´å¥½çš„å‰¥ç¦»ç›®æ ‡å®ä½“çš„è·å–å’Œé…åˆUIKitè¿™ä¸€å±‚çš„è½¬åœºé€»è¾‘æ˜¯ä¸€é¡¹æ¯”è¾ƒå¤æ‚çš„æŒ‘æˆ˜ï¼Œè·¯ç”±å®é™…ä¸Šæ˜¯å……å½“MVVMçš„ViewModelä¸­æ¯”è¾ƒè§£è€¦çš„ç›®æ ‡è·å–é€»è¾‘å’ŒVIPERä¸­Routerå±‚ï¼ŒPä¸Vçš„è°ƒç”¨å…¨éƒ¨é Routerè½¬å‘ã€‚
åœ¨å®æ–½ä»¥ç»„ä»¶åŒ–ä¸ºç›®çš„çš„å·¥ç¨‹åŒ–æ”¹é€ ä¸­ï¼Œå¦‚ä½•æŠ½ç¦»å•ç‹¬ä¸šåŠ¡ä¸ºç»„ä»¶ï¼Œæ¯”è¾ƒå¥½çš„ç®¡ç†ä¸šåŠ¡ä¸ä¸šåŠ¡ä¹‹é—´çš„ä¾èµ–ï¼Œå°±å¿…é¡»ä½¿ç”¨ä¸€ä¸ªå…¥ä¾µæ¯”è¾ƒå°çš„Routeï¼ŒWLRRouteå…¥ä¾µçš„åœ°æ–¹åœ¨äºWLRRouteHandlerçš„transitionWithRequesté€»è¾‘ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªUIViewControllerçš„æ‰©å±•ï¼Œç»™ targetViewController.wlr_request = request;è®¾ç½®äº†WLRRouteRequestå¯¹è±¡ç»™ç›®æ ‡ä¸šåŠ¡ï¼Œä½†è™½ç„¶å¦‚æ­¤ï¼Œä½ ä¾æ—§å¯ä»¥é‡å†™WLRRouteHandlerçš„transitionWithRequestæ–¹æ³•ï¼Œæ¥æ„å»ºä½ è‡ªå·±å‚æ•°ä¼ é€’æ–¹å¼ï¼Œè¿™ä¸€ç‚¹å®Œå…¨å–å†³äºä½ å¦‚ä½•æ›´å¥½çš„ä½¿å¾—ä¸šåŠ¡æ— æ„ŸçŸ¥è€Œä½¿ç”¨è·¯ç”±ã€‚

æœ€åé™„ä¸Šä»£ç åœ°å€ï¼š
å–œæ¬¢çš„æ¥ä¸ªæ˜Ÿå§â€¦
https://github.com/Neojoke/WLRRoute
12.27æ›´æ–°ï¼š
æ„Ÿè°¢è¿™ä½åŒå­¦ï¼Œå†™äº†ä¸€ç¯‡è®¨è®ºæ€§çš„ [æ–‡ç« ](http://www.jianshu.com/p/a6f6086b54ac)ï¼Œå¯¹æˆ‘å¯å‘å¾ˆå¤§ï¼Œæˆ‘å°Šæ•¬ä»¥åŠæ¬£èµèƒ½å¤Ÿæ·±å…¥æ€è€ƒå¹¶ä¸”æ„¿æ„åˆ†äº«è‡ªå·±çš„ideaçš„äººã€‚
2017.02.26æ›´æ–°ï¼š
WLRRouteå¢åŠ äº†æ ¸å¿ƒé€»è¾‘çš„æ³¨é‡Šå‡çº§åˆ°0.0.9ç‰ˆæœ¬ï¼Œä¸‹ä¸€ä¸ª0.1.0ç‰ˆæœ¬å°†åŠ å…¥å¼‚æ­¥å¤„ç†ï¼Œæ•¬è¯·æœŸå¾…
2017.03.01æ›´æ–°ï¼š
æ›´æ–°æ–‡ç« çš„æ•´ä½“é˜…è¯»æµç•…åº¦
