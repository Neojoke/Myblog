---
title: 3DTouch-å°åº”ç”¨
date: 2015-11-09 23:59:00
categories:
- è¡¨-iOSç•Œé¢å¼€å‘åº”ç”¨
tags:
- iOS
- UI
---

æœ€è¿‘é¡¹ç›®å¿™ï¼ŒèŠ±åœ¨ç ”ç©¶æ–°æŠ€æœ¯çš„æ—¶é—´å˜å°‘äº†ï¼Œä½†æ—¥æ‹±ä¸€å’ï¼ŒæŠŠæœ€è¿‘çš„ 3DTouch ç ”ç©¶ä¸€ä¸‹ï¼Œä¸è¿‡è¿™å›è®²çš„ä¸æ˜¯ 3DTouch ä¸­çš„å¦‚ä½•è¯•ç€ app çš„ icon å¿«æ·æ“ä½œæˆ–è€…æ˜¯ pop å’Œ pickï¼Œè¿™å›çš„ä¸»è§’æ˜¯ UITouch å¯¹è±¡ä¸­çš„ force å±æ€§ã€‚
ä¸‹é¢æ‘˜è‡ªå®˜æ–¹æ–‡æ¡£ï¼š

![å®˜æ–¹æ–‡æ¡£.jpg](http://upload-images.jianshu.io/upload_images/24274-a51e8ef63f34d361.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è¿™ä¸ª force å±æ€§æ˜¯å±äº UITouch å¯¹è±¡ï¼Œå®æµ‹ä¸‹æ¥å€¼åœ¨ 1.0-6.0 ä¹‹é—´ï¼Œå¯ä»¥åœ¨ iPhone6s ä¸Šè·å–è¿™ä¸ªå€¼ã€‚ä»¥ä¸‹æ˜¯ Demo:

![demo.mov.gif](http://upload-images.jianshu.io/upload_images/24274-57765de90838799d.gif?imageMogr2/auto-orient/strip)
å…¶å®æˆ‘æƒ³äº†æƒ³ï¼Œ3DTouch ç»™äºˆ App æ–°çš„äº¤äº’ç»´åº¦ï¼Œå®é™…ä¸Šæ˜¯åœ¨å°çš„åœ°æ–¹ç®€åŒ–ç”¨æˆ·çš„æ“ä½œï¼ŒåŸæ¥éœ€è¦ä¸¤æ­¥ç‚¹å‡»è·³è½¬ç•Œé¢æ”¾å¤§æˆ–è€…æ˜¯åŒæŒ‡æåˆæ”¾å¤§å¯ä»¥å˜æˆä¸€ä¸ªé‡åŠ›æŒ‰å‹å°±å¯ä»¥æ”¾å¤§äº†ã€‚è¿˜å¯ä»¥åšå‡ºä¸€äº›å¯äº¤äº’æ§ä»¶çš„æ§ä»¶ï¼Œä¾‹å¦‚ button å¯ä»¥æœ‰æ›´å¥½çš„è§†è§‰åé¦ˆï¼Œæˆ‘ç®€å•çš„ç”¨æ”¾å¤§æ¥å®ç°ï¼Œå…¶å®å¯ä»¥ç”¨å‹åŠ›å’Œé˜´å½±å•Šï¼Œå½¢å˜å•ŠæŒ‚é’©ï¼Œåšå‡ºæ›´æœ‰æ„æ€çš„äº¤äº’ã€‚
å¦‚ä½•ä½¿ç”¨ï¼Œå¾ˆç®€å•ï¼ŒDemo ä¸­å»ºç«‹äº†ä¸¤ä¸ªå­ç±»ï¼Œä¸€ä¸ªæ˜¯ UIButton å­ç±»--ForceButtonï¼Œä¸€ä¸ªæ˜¯ UIGestureRecognizer å­ç±»--ForceGestureRecognizerã€‚
åœ¨å­ç±»é‡Œé‡å†™ touchesBeganã€touchesMovedã€touchesEnded è¿™äº›å‡½æ•°ï¼Œç„¶åè®¾ç½® force çš„å›è°ƒï¼š
`var forceTouchCallBack:((state:UIGestureRecognizerState,force:CGFloat,gestureReconginzer:UIGestureRecognizer)->Void)?;`
å°±å¤§åŠŸå‘Šæˆäº†ã€‚
è´´å‡ºå®Œæ•´ä»£ç ï¼š

```Swift
class ForceGestureRecognizer: UIGestureRecognizer {
    var forceValue:CGFloat = 0
    private var forceTouchCallBack:((state:UIGestureRecognizerState,force:CGFloat,gestureReconginzer:UIGestureRecognizer)->Void)?;
    public func addForceCallBack(callBack:(state:UIGestureRecognizerState,force:CGFloat,gestureReconginzer: UIGestureRecognizer)->Void){
        self.forceTouchCallBack = callBack;
    }
    override func touchesBegan(touches: Set<UITouch>, withEvent event: UIEvent) {
        super.touchesBegan(touches, withEvent: event)
        guard let touch = touches.first else{
            return
        }
        if let callback = forceTouchCallBack{
            callback(state: UIGestureRecognizerState.Began,force: touch.force,gestureReconginzer: self);
        }
    }
    override func touchesMoved(touches: Set<UITouch>, withEvent event: UIEvent) {
        super.touchesMoved(touches, withEvent: event)
        guard let touch = touches.first else{
            return
        }
        if let callback = forceTouchCallBack{
            callback(state: UIGestureRecognizerState.Changed,force: touch.force,gestureReconginzer: self);
        }
    }
    override func touchesEnded(touches: Set<UITouch>, withEvent event: UIEvent) {
        super.touchesEnded(touches, withEvent: event)
        guard let touch = touches.first else{
            return
        }
        if let callback = forceTouchCallBack{
            callback(state: UIGestureRecognizerState.Ended,force: touch.force,gestureReconginzer: self);
        }
    }
}
```

æœ‰äº†è¿™ä¸ªè‡ªå®šä¹‰çš„ ForceGestureRecognizerï¼Œå°±å¯ä»¥å¢åŠ åˆ°ä»»æ„çš„å¯¹è±¡ä¸Šå»ï¼Œé€šè¿‡è®¾ç½®å›è°ƒï¼š

```Swift
  let gestureRecognizer = ForceGestureRecognizer()
        gestureRecognizer.addForceCallBack { (state, force, gestureReconginzer) -> Void in
            print(NSStringFromCGSize(self.customView.frame.size))
            if state == UIGestureRecognizerState.Changed{
                if self.customView.frame.size.width > UIScreen.mainScreen().bounds.size.width{
                    return
                }
            }
              self.customView.layer.transform = CATransform3DMakeScale(1+force/6, 1+force/6, 1)

        };
```

å®ç°è‡ªå·±æƒ³è¦çš„æ•ˆæœ
æ˜¯å¦å¾ˆç®€å•å‘¢ï¼Ÿ
å¥‰ä¸Šæºç [Demo](https://github.com/Neojoke/3DTouchButton-GestureRecognizer)
å–œæ¬¢çš„ç‚¹ä¸ªèµ ğŸ‘
